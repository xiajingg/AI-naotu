/*!
 * ====================================================
 * kityminder-editor - v1.0.67 - 2025-02-27
 * https://github.com/fex-team/kityminder-editor
 * GitHub: https://github.com/fex-team/kityminder-editor 
 * Copyright (c) 2025 ; Licensed 
 * ====================================================
 */


!function(){var m={r:function(e){if(m[e].inited)return m[e].value;if("function"!=typeof m[e].value)return m[e].inited=!0,m[e].value;var t={exports:{}},n=m[e].value(null,t.exports,t);if(m[e].inited=!0,(m[e].value=n)!==undefined)return n;for(var r in t.exports)if(t.exports.hasOwnProperty(r))return m[e].inited=!0,m[e].value=t.exports,t.exports}};m[0]={value:function(e,t,n){var r=[];function i(e){r.push(e)}function o(e){this.selector=e;for(var t=0;t<r.length;t++)"function"==typeof r[t]&&r[t].call(this,this)}return(o.assemble=i)(m.r(7)),i(m.r(9)),i(m.r(14)),i(m.r(18)),i(m.r(11)),i(m.r(12)),i(m.r(5)),i(m.r(6)),i(m.r(8)),i(m.r(15)),i(m.r(10)),i(m.r(13)),i(m.r(16)),i(m.r(17)),n.exports=o}},m[1]={value:function(e,t,n){return n.exports=kityminder.Editor=m.r(0)}},m[2]={value:function(e,t,n){return n.exports=window.HotBox}},m[3]={value:function(e,t,n){}},m[4]={value:function(e,t,n){return n.exports=window.kityminder.Minder}},m[5]={value:function(e,t,n){function r(){var r="\ufeff",i={"application/km":"\uffff"},n={"\ufeff":"SPLITOR","\uffff":"application/km"};function o(e,t){if(!this.isPureText(t)){var n;if(!this.whichMimeType(t))throw new Error("unknow mimetype!");t=this.getPureText(t)}return!1===e?t:e+r+t}this.registMimeTypeProtocol=function(e,t){if(t&&n[t])throw new Error("sing has registed!");if(e&&i[e])throw new Error("mimetype has registed!");n[t]=e,i[e]=t},this.getMimeTypeProtocol=function(e,t){var n=i[e]||!1;return t===undefined?o.bind(this,n):o(n,t)},this.getSpitor=function(){return r},this.getMimeType=function(e){return e!==undefined?n[e]||null:i}}function i(){this.minder.supportClipboardEvent&&!kity.Browser.gecko&&(this.MimeType=new r)}return r.prototype.isPureText=function(e){return!~e.indexOf(this.getSpitor())},r.prototype.getPureText=function(e){return this.isPureText(e)?e:e.split(this.getSpitor())[1]},r.prototype.whichMimeType=function(e){return this.isPureText(e)?null:this.getMimeType(e.split(this.getSpitor())[0])},n.exports=i}},m[6]={value:function(e,t,n){function r(){var u=this.minder,i=window.kityminder.data;if(u.supportClipboardEvent&&!kity.Browser.gecko){var m=this.fsm,p=this.receiver,d=this.MimeType,o=d.getMimeTypeProtocol("application/km"),s=i.getRegisterProtocol("json").decode,g=[],e=function(e){if(document.activeElement==p.element){var t=e,n;switch(m.state()){case"input":break;case"normal":var r=[].concat(u.getSelectedNodes());if(r.length){var i;if(1<r.length)if(r.sort(function(e,t){return e.getLevel()-t.getLevel()}),(i=r[0].getLevel())!==r[r.length-1].getLevel()){var o,a,l=0,c=r.length,d=c-1;for(a=r[d];a.getLevel()!==i;){for(l=0;l<c&&r[l].getLevel()===i;){if(r[l].isAncestorOf(a)){r.splice(d,1);break}l++}a=r[--d]}}var s=f(r);t.clipboardData.setData("text/plain",s)}e.preventDefault()}}},t=function(e){if(document.activeElement==p.element){if("normal"!==u.getStatus())return void e.preventDefault();var t=e,n;switch(m.state()){case"input":break;case"normal":var r=u.getSelectedNodes();r.length&&(t.clipboardData.setData("text/plain",f(r)),u.execCommand("removenode")),e.preventDefault()}}},n=function(e){if(document.activeElement==p.element){if("normal"!==u.getStatus())return void e.preventDefault();var t=e,n=m.state(),r=t.clipboardData.getData("text/plain");switch(n){case"input":if(!d.isPureText(r))return void e.preventDefault();break;case"normal":var i=u.getSelectedNodes();if("application/km"===d.whichMimeType(r)){var o=s(d.getPureText(r)),a;i.forEach(function(e){for(var t=o.length-1;0<=t;t--)a=u.createNode(null,e),u.importNode(a,o[t]),g.push(a),e.appendChild(a)}),u.select(g,!0),g=[],u.refresh()}else{if(t.clipboardData&&-1<t.clipboardData.items[0].type.indexOf("image")){var l=t.clipboardData.items[0].getAsFile(),c;return angular.element(document.body).injector().get("server").uploadImage(l).then(function(e){var t=e.data;0===t.errno&&u.execCommand("image",t.data.url)})}i.forEach(function(e){u.Text2Children(e,r)})}e.preventDefault()}}};document.addEventListener("copy",e),document.addEventListener("cut",t),document.addEventListener("paste",n)}function f(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(u.exportNode(e[n]));return o(i.getRegisterProtocol("json").encode(t))}}return n.exports=r}},m[7]={value:function(e,t,n){function r(){var e;if(!(e="string"==typeof this.selector?document.querySelector(this.selector):this.selector))throw new Error("Invalid selector: "+this.selector);e.classList.add("km-editor"),this.container=e}return n.exports=r}},m[8]={value:function(e,t,n){var w=m.r(2),r,i=new(m.r(19))("drag");function o(){var t=this.fsm,o=this.minder,n=this.hotbox,e,r=this.receiver.element,i,a;function l(){t.when("* -> drag",function(){}),t.when("drag -> *",function(e,t,n){})}l();var c=0,d=1,s=20,u=1,m,p,g,f,v,h=!1,b=!1,y;function k(e,t){if(!e)return h=b=!1,y&&kity.releaseFrame(y),void(y=null);var n,r,i;y||(y=kity.requestFrame((n=e,r=t,i=o,function(e){switch(n){case"left":i._viewDragger.move({x:-r,y:0},0);break;case"top":i._viewDragger.move({x:0,y:-r},0);break;case"right":i._viewDragger.move({x:r,y:0},0);break;case"bottom":i._viewDragger.move({x:0,y:r},0);break;default:return}e.next()})))}o.on("mousedown",function(e){u=0;var t=o.getPaper().container.getBoundingClientRect();i=e.originEvent.clientX,a=e.originEvent.clientY,v=t.top,m=t.width,p=t.height}),o.on("mousemove",function(e){if("drag"===t.state()&&0==u&&o.getSelectedNode()&&(20<Math.abs(i-e.originEvent.clientX)||20<Math.abs(a-e.originEvent.clientY))&&(g=e.originEvent.clientX,f=e.originEvent.clientY-v,g<20?k("right",20-g):m-20<g?k("left",20+g-m):h=!0,f<20?k("bottom",f):p-20<f?k("top",20+f-p):b=!0,h&&b&&k(!1)),"drag"!==t.state()&&0===u&&o.getSelectedNode()&&(20<Math.abs(i-e.originEvent.clientX)||20<Math.abs(a-e.originEvent.clientY)))return"hotbox"===t.state()&&n.active(w.STATE_IDLE),t.jump("drag","user-drag")}),window.addEventListener("mouseup",function(){if(u=1,"drag"===t.state())return k(!1),t.jump("normal","drag-finish")},!1)}return n.exports=o}},m[9]={value:function(e,t,n){var r,s=new(m.r(19))("fsm");function u(e,t,n,r){return e.when==t&&(("*"==e.enter||e.enter==r)&&("*"==e.exit||e.exit==n||void 0))}function i(e){var a=e,l=" - ",c=" -> ",d=[];this.jump=function(e,t){if(!t)throw new Error("Please tell fsm the reason to jump");var n=a,r=[n,e].concat([].slice.call(arguments,1)),i,o;for(i=0;i<d.length;i++)if(u((o=d[i]).condition,"before",n,e)&&o.apply(null,r))return;for(a=e,s.log("[{0}] {1} -> {2}",t,n,e),i=0;i<d.length;i++)u((o=d[i]).condition,"after",n,e)&&o.apply(null,r);return a},this.state=function(){return a},this.when=function(e,t){var n,r,i,o;if(1==arguments.length&&(t=e,e="* -> *"),2==(r=e.split(l)).length?n="before":2==(r=e.split(c)).length&&(n="after"),!n)throw new Error("Illegal fsm condition: "+e);i=r[0],o=r[1],t.condition={when:n,exit:i,enter:o},d.push(t)}}function o(){this.fsm=new i("normal")}return n.exports=o}},m[10]={value:function(e,t,n){var h=m.r(22);function r(){var n=this.minder,e=this.hotbox,r=100,i,o,a,t;function l(){a=[],t=[],i=n.exportJson()}function c(){var e=n.exportJson(),t=h(e,i);if(t.length){for(a.push(t);a.length>r;)a.shift();return i=e,!0}}function d(){var e=n.exportJson();t.push(h(e,i)),i=e}function s(){o=!0;var e=a.pop();e&&(n.applyPatches(e),d()),o=!1}function u(){o=!0;var e=t.pop();e&&(n.applyPatches(e),c()),o=!1}function m(){o||c()&&(t=[])}function p(){return!!a.length}function g(){return!!t.length}function f(e){if(o){var t=e.patch;switch(t.express){case"node.add":n.select(t.node.getChild(t.index),!0);break;case"node.remove":case"data.replace":case"data.remove":case"data.add":n.select(t.node,!0)}}}this.history={reset:l,undo:s,redo:u,hasUndo:p,hasRedo:g},l(),n.on("contentchange",m),n.on("import",l),n.on("patch",f);var v=e.state("main");v.button({position:"top",label:"\u64a4\u9500",key:"Ctrl + Z",enable:p,action:s,next:"idle"}),v.button({position:"top",label:"\u91cd\u505a",key:"Ctrl + Y",enable:g,action:u,next:"idle"})}return window.diff=h,n.exports=r}},m[11]={value:function(e,t,n){var r=m.r(2);function i(){var e=this.fsm,a=this.minder,i=this.receiver,t=this.container,l=new r(t);l.setParentFSM(e),e.when("normal -> hotbox",function(e,t,n){var r=a.getSelectedNode(),i;if(r){var o=r.getRenderBox();i={x:o.cx,y:o.cy}}l.active("main",i)}),e.when("normal -> normal",function(e,t,n,r){var i;"shortcut-handle"==n&&(l.dispatch(r)?r.preventDefault():a.dispatchKeyEvent(r))}),e.when("modal -> normal",function(e,t,n,r){"import-text-finish"==n&&i.element.focus()}),this.hotbox=l}return n.exports=i}},m[12]={value:function(e,t,n){m.r(21);var r,g=new(m.r(19))("input");function i(){var i=this.fsm,b=this.minder,e=this.hotbox,o=this.receiver,a=o.element,l=window.kity.Browser.gecko;function t(){i.when("* -> input",d),i.when("input -> *",function(e,t,n){switch(n){case"input-cancel":return y();case"input-commit":default:return m()}}),o.onblur(function(e){"input"==i.state()&&i.jump("normal","input-commit")}),b.on("beforemousedown",function(){"input"==i.state()&&i.jump("normal","input-commit")}),b.on("dblclick",function(){b.getSelectedNode()&&"readonly"!==b._status&&c()})}function n(){g.flaged&&a.classList.add("debug"),a.onmousedown=function(e){e.stopPropagation()},b.on("layoutallfinish viewchange viewchanged selectionchange",function(e){"viewchange"==e.type&&"input"!=i.state()||p()}),p()}function r(){e.state("main").button({position:"center",label:"\u7f16\u8f91",key:"F2",enable:function(){return-1!=b.queryCommandState("text")},action:c})}function c(){var e=b.getSelectedNode();if(e){var t=a;if(a.innerText="","bold"===e.getData("font-weight")){var n=document.createElement("b");t.appendChild(n),t=n}if("italic"===e.getData("font-style")){var r=document.createElement("i");t.appendChild(r),t=r}t.innerText=b.queryCommandValue("text"),l&&o.fixFFCaretDisappeared(),i.jump("input","input-request"),o.selectAll()}}function d(){var e=b.getSelectedNode();if(e){var t=e.getData("font-size")||e.getStyle("font-size");a.style.fontSize=t+"px",a.style.minWidth=0,a.style.minWidth=a.clientWidth+"px",a.style.fontWeight=e.getData("font-weight")||"",a.style.fontStyle=e.getData("font-style")||"",a.classList.add("input"),a.focus()}}function s(e){for(var t="",n="\t",r="\n",i=/\S/,o=" ",a=new RegExp("( |"+String.fromCharCode(160)+")"),l=document.createElement("br"),c=!1,d=!1,s,u,m,p,g,f=0,v=e.length;f<v;f++)switch(s=e[f],Object.prototype.toString.call(s)){case"[object HTMLBRElement]":t+=r;break;case"[object Text]":if(s=s.textContent.replace("&nbsp;"," "),i.test(s))t+=s;else for(m=s.length;m--;)a.test(s[m])?t+=o:s[m]===n&&(t+=n);break;case"[object HTMLElement]":switch(s.nodeName){case"B":c=!0;break;case"I":d=!0}[].splice.apply(e,[f,1].concat([].slice.call(s.childNodes))),v=e.length,f--;break;case"[object HTMLSpanElement]":[].splice.apply(e,[f,1].concat([].slice.call(s.childNodes))),v=e.length,f--;break;case"[object HTMLImageElement]":s.src&&/http(|s):\/\//.test(s.src)&&b.execCommand("Image",s.src,s.alt);break;case"[object HTMLDivElement]":u=[];for(var h=0,v=s.childNodes.length;h<v;h++)u.push(s.childNodes[h]);u.push(l),[].splice.apply(e,[f,1].concat(u)),v=e.length,f--;break;default:if(s&&s.childNodes.length){u=[];for(var h=0,v=s.childNodes.length;h<v;h++)u.push(s.childNodes[h]);u.push(l),[].splice.apply(e,[f,1].concat(u)),v=e.length,f--}else s&&s.textContent!==undefined?t+=s.textContent:t+=""}return t=(t=t.replace(/^\n*|\n*$/g,"")).replace(new RegExp("(\n|\r|\n\r)( |"+String.fromCharCode(160)+"){4}","g"),"$1\t"),b.getSelectedNode().setText(t),c?b.queryCommandState("bold")||b.execCommand("bold"):b.queryCommandState("bold")&&b.execCommand("bold"),d?b.queryCommandState("italic")||b.execCommand("italic"):b.queryCommandState("italic")&&b.execCommand("italic"),y(),t}function u(t,e){try{b.decodeData("text",e).then(function(e){function l(e,t,n){var r=t.data;e.setText(r.text||"");for(var i=t.children||[],o=0;o<i.length;o++){var a;l(n.createNode(null,e),i[o],n)}return e}l(t,e,b),b.fire("contentchange"),b.getRoot().renderTree(),b.layout(300)})}catch(n){if(b.fire("contentchange"),b.getRoot().renderTree(),"Error: Invalid local format"!==n.toString())throw n}}function m(){var e=[].slice.call(a.childNodes);setTimeout(function(){a.innerHTML=""},0);var t=b.getSelectedNode();if(u(t,e=s(e)),"root"==t.type){var n=b.getRoot().getText();b.fire("initChangeRoot",{text:n})}}function y(){a.classList.remove("input"),o.selectAll()}function p(){var t=p,n=b.getSelectedNode();n&&(t.timer||(t.timer=setTimeout(function(){var e=n.getRenderBox("TextRenderer");a.style.left=Math.round(e.x)+"px",a.style.top=(g.flaged?Math.round(e.bottom+30):Math.round(e.y))+"px",t.timer=0})))}n(),t(),r(),this.editText=c}return n.exports=i}},m[13]={value:function(e,t,n){var s=m.r(2);function u(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(65<=e.keyCode&&e.keyCode<=90||(48<=e.keyCode&&e.keyCode<=57||(108!=e.keyCode&&96<=e.keyCode&&e.keyCode<=111||(108!=e.keyCode&&96<=e.keyCode&&e.keyCode<=111||(229==e.keyCode||0===e.keyCode)))))}function r(){var n=this.fsm,t=this.minder,r=this.receiver,e=this.container,i=r.element,o=this.hotbox,a=!1,l,c;r.listen("normal",function(e){if(r.enable(),e.is("Space"))return e.preventDefault(),kity.Browser.safari&&(i.innerHTML=""),n.jump("hotbox","space-trigger");switch(e.type){case"keydown":if(t.getSelectedNode()){if(u(e))return n.jump("input","user-input")}else i.innerHTML="";n.jump("normal","shortcut-handle",e)}}),r.listen("hotbox",function(e){r.disable(),e.preventDefault();var t=o.dispatch(e);if(o.state()==s.STATE_IDLE&&"hotbox"==n.state())return n.jump("normal","hotbox-idle")}),r.listen("input",function(e){if(r.enable(),"keydown"==e.type){if(e.is("Enter"))return e.preventDefault(),n.jump("normal","input-commit");if(e.is("Esc"))return e.preventDefault(),n.jump("normal","input-cancel");(e.is("Tab")||e.is("Shift + Tab"))&&e.preventDefault()}else if("keyup"==e.type&&e.is("Esc")){if(e.preventDefault(),!a)return n.jump("normal","input-cancel")}else"compositionstart"==e.type?a=!0:"compositionend"==e.type&&setTimeout(function(){a=!1})});var d=2;e.addEventListener("mousedown",function(e){2==e.button&&e.preventDefault(),"hotbox"==n.state()?(o.active(s.STATE_IDLE),n.jump("normal","blur")):"normal"==n.state()&&2==e.button&&(l=e.clientX,c=e.clientY)},!1),e.addEventListener("mousewheel",function(e){"hotbox"==n.state()&&(o.active(s.STATE_IDLE),n.jump("normal","mousemove-blur"))},!1),e.addEventListener("contextmenu",function(e){e.preventDefault()}),e.addEventListener("mouseup",function(e){"normal"==n.state()&&2==e.button&&e.clientX==l&&e.clientY==c&&t.getSelectedNode()&&n.jump("hotbox","content-menu")},!1),o.$element.addEventListener("mousedown",function(e){e.stopPropagation()})}return n.exports=r}},m[14]={value:function(e,t,n){var r=m.r(4);function i(){var e=new r({enableKeyReceiver:!1,enableAnimation:!0});e.renderTo(this.selector),e.setTheme(null),e.select(e.getRoot(),!0),e.execCommand("text","\u4e2d\u5fc3\u4e3b\u9898"),this.minder=e}return n.exports=i}},m[15]={value:function(e,t,n){function r(){var o=this,a=this.minder,e=this.hotbox,l=this.fsm,c=e.state("main"),t,d=0;function n(){a.fire("importNodeData")}function r(){a.fire("exportNodeData")}["\u524d\u79fb:Alt+Up:ArrangeUp","\u4e0b\u7ea7:Tab|Insert:AppendChildNode","\u540c\u7ea7:Enter:AppendSiblingNode","\u540e\u79fb:Alt+Down:ArrangeDown","\u5220\u9664:Delete|Backspace:RemoveNode","\u4e0a\u7ea7:Shift+Tab|Shift+Insert:AppendParentNode"].forEach(function(e){var t=e.split(":"),n=t.shift(),r=t.shift(),i=t.shift();c.button({position:"ring",label:n,key:r,action:function(){if(0===i.indexOf("Append")){function e(){--d||o.editText(),a.off("layoutallfinish",e)}d++,a.execCommand(i,"\u5206\u652f\u4e3b\u9898"),a.on("layoutallfinish",e)}else a.execCommand(i),l.jump("normal","command-executed")},enable:function(){return-1!=a.queryCommandState(i)}})}),c.button({position:"bottom",label:"\u5bfc\u5165\u8282\u70b9",key:"Alt + V",enable:function(){var e;return 1==a.getSelectedNodes().length},action:n,next:"idle"}),c.button({position:"bottom",label:"\u5bfc\u51fa\u8282\u70b9",key:"Alt + C",enable:function(){var e;return 1==a.getSelectedNodes().length},action:r,next:"idle"})}return n.exports=r}},m[16]={value:function(e,t,n){function r(){var t=this.minder,e=this.hotbox,n;e.state("main").button({position:"top",label:"\u4f18\u5148\u7ea7",key:"P",next:"priority",enable:function(){return-1!=t.queryCommandState("priority")}});var r=e.state("priority");"123456789".replace(/./g,function(e){r.button({position:"ring",label:"P"+e,key:e,action:function(){t.execCommand("Priority",e)}})}),r.button({position:"center",label:"\u79fb\u9664",key:"Del",action:function(){t.execCommand("Priority",0)}}),r.button({position:"top",label:"\u8fd4\u56de",key:"esc",next:"back"})}return n.exports=r}},m[17]={value:function(e,t,n){function r(){var t=this.minder,e=this.hotbox,n;e.state("main").button({position:"top",label:"\u8fdb\u5ea6",key:"G",next:"progress",enable:function(){return-1!=t.queryCommandState("progress")}});var r=e.state("progress");"012345678".replace(/./g,function(e){r.button({position:"ring",label:"G"+e,key:e,action:function(){t.execCommand("Progress",parseInt(e)+1)}})}),r.button({position:"center",label:"\u79fb\u9664",key:"Del",action:function(){t.execCommand("Progress",0)}}),r.button({position:"top",label:"\u8fd4\u56de",key:"esc",next:"back"})}return n.exports=r}},m[18]={value:function(e,t,n){var l=m.r(23),r=m.r(2);function i(){var i=this.fsm,e=this.minder,t=this,n=document.createElement("div");n.contentEditable=!0,n.setAttribute("tabindex",-1),n.classList.add("receiver"),n.onkeydown=n.onkeypress=n.onkeyup=a,n.addEventListener("compositionstart",a),this.container.appendChild(n);var r={element:n,selectAll:function(){n.innerHTML||(n.innerHTML="&nbsp;");var e=document.createRange(),t=window.getSelection();e.selectNodeContents(n),t.removeAllRanges(),t.addRange(e),n.focus()},enable:function(){n.setAttribute("contenteditable",!0)},disable:function(){n.setAttribute("contenteditable",!1)},fixFFCaretDisappeared:function(){n.removeAttribute("contenteditable"),n.setAttribute("contenteditable","true"),n.blur(),n.focus()},onblur:function(e){n.onblur=e}};r.selectAll(),e.on("beforemousedown",r.selectAll),e.on("receiverfocus",r.selectAll),e.on("readonly",function(){e.disable(),editor.receiver.element.parentElement.removeChild(editor.receiver.element),editor.hotbox.$container.removeChild(editor.hotbox.$element)});var o=[];function a(e){var t,n;e.is=function(e){for(var t=e.split("|"),n=0;n<t.length;n++)if(l.is(this,t[n]))return!0;return!1};for(var r=0;r<o.length;r++)if(("*"==(t=o[r]).notifyState||t.notifyState==i.state())&&t.call(null,e))return}r.listen=function(e,t){1==arguments.length&&(t=e,e="*"),t.notifyState=e,o.push(t)},this.receiver=r}return n.exports=i}},m[19]={value:function(e,t,n){var o=m.r(20);function a(){}function l(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function r(t){var e;if(this.flaged=-1!=window.location.search.indexOf(t)){var n=l(t)%360,r=o("background: hsl({0}, 50%, 80%); color: hsl({0}, 100%, 30%); padding: 2px 3px; margin: 1px 3px 0 0;border-radius: 2px;",n),i="background: none; color: black;";this.log=function(){var e=o.apply(null,arguments);console.log(o("%c{0}%c{1}",t,e),r,i)}}else this.log=a}return n.exports=r}},m[20]={value:function(e,t,n){function r(e,n){return"object"!=typeof n&&(n=[].slice.call(arguments,1)),String(e).replace(/\{(\w+)\}/gi,function(e,t){return n[t]||t})}return n.exports=r}},m[21]={value:function(e,t,n){!("innerText"in document.createElement("a"))&&"getSelection"in window&&(HTMLElement.prototype.__defineGetter__("innerText",function(){var e=window.getSelection(),t=[],n,r;for(r=0;r<e.rangeCount;r++)t[r]=e.getRangeAt(r);for(e.removeAllRanges(),e.selectAllChildren(this),n=e.toString(),e.removeAllRanges(),r=0;r<t.length;r++)e.addRange(t[r]);return n}),HTMLElement.prototype.__defineSetter__("innerText",function(e){this.innerHTML=(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}))}},m[22]={value:function(e,t,n){var m=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function g(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function f(e,t,n,r){for(var i=m(t),o=m(e),a=!1,l=!1,c=o.length-1;0<=c;c--){var d,s=e[d=o[c]];if(t.hasOwnProperty(d)){var u=t[d];"object"==typeof s&&null!=s&&"object"==typeof u&&null!=u?f(s,u,n,r+"/"+p(d)):s!=u&&(a=!0,n.push({op:"replace",path:r+"/"+p(d),value:g(u)}))}else n.push({op:"remove",path:r+"/"+p(d)}),l=!0}if(l||i.length!=o.length)for(var c=0;c<i.length;c++){var d=i[c];e.hasOwnProperty(d)||n.push({op:"add",path:r+"/"+p(d),value:g(t[d])})}}function r(e,t){var n=[];return f(e,t,n,""),n}return n.exports=r}},m[23]={value:function(e,t,n){var r=m.r(24),i=4096,o=8192,a=16384;function l(e){return"string"==typeof e?s(e):d(e)}function c(e,t){return e&&t&&l(e)==l(t)}function d(e){var t=0;if((e.ctrlKey||e.metaKey)&&(t|=i),e.altKey&&(t|=o),e.shiftKey&&(t|=a),-1===[16,17,18,91].indexOf(e.keyCode)){if(229===e.keyCode&&e.keyIdentifier)return t|parseInt(e.keyIdentifier.substr(2),16);t|=e.keyCode}return t}function s(e){var t=0;return e.toLowerCase().split(/\s*\+\s*/).forEach(function(e){switch(e){case"ctrl":case"cmd":t|=i;break;case"alt":t|=o;break;case"shift":t|=a;break;default:t|=r[e]}}),t}t.hash=l,t.is=c}},m[24]={value:function(e,t,n){var r={Shift:16,Control:17,Alt:18,CapsLock:20,BackSpace:8,Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,Direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190};for(var i in r)r.hasOwnProperty(i)&&(r[i.toLowerCase()]=r[i]);var o=65,a="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e){r[e]=e.charCodeAt(0)-a+65});for(var l=9;r[l.toString()]=l+48,--l;);n.exports=r}};var t={"expose-editor":1};function e(e){m.r([t[e]])}angular.module("kityminderEditor",["ui.bootstrap","ui.codemirror","ui.colorpicker"]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","http://agroup.baidu.com:8910/**","http://cq01-fe-rdtest01.vm.baidu.com:8910/**","http://agroup.baidu.com:8911/**"])}]),angular.module("kityminderEditor").run(["$templateCache",function(e){"use strict";e.put("ui/directive/appendNode/appendNode.html","<div class=\"km-btn-group append-group\"><div class=\"km-btn-item append-child-node\" ng-disabled=\"minder.queryCommandState('AppendChildNode') === -1\" ng-click=\"minder.queryCommandState('AppendChildNode') === -1 || execCommand('AppendChildNode')\" title=\"{{ 'appendchildnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendchildnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item append-parent-node\" ng-disabled=\"minder.queryCommandState('AppendParentNode') === -1\" ng-click=\"minder.queryCommandState('AppendParentNode') === -1 || execCommand('AppendParentNode')\" title=\"{{ 'appendparentnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendparentnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item append-sibling-node\" ng-disabled=\"minder.queryCommandState('AppendSiblingNode') === -1\" ng-click=\"minder.queryCommandState('AppendSiblingNode') === -1 ||execCommand('AppendSiblingNode')\" title=\"{{ 'appendsiblingnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'appendsiblingnode' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/arrange/arrange.html","<div class=\"km-btn-group arrange-group\"><div class=\"km-btn-item arrange-up\" ng-disabled=\"minder.queryCommandState('ArrangeUp') === -1\" ng-click=\"minder.queryCommandState('ArrangeUp') === -1 || minder.execCommand('ArrangeUp')\" title=\"{{ 'arrangeup' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'arrangeup' | lang:'ui/command' }}</span></div><div class=\"km-btn-item arrange-down\" ng-disabled=\"minder.queryCommandState('ArrangeDown') === -1\" ng-click=\"minder.queryCommandState('ArrangeDown') === -1 || minder.execCommand('ArrangeDown');\" title=\"{{ 'arrangedown' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'arrangedown' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/colorPanel/colorPanel.html",'<div class="bg-color-wrap"><span class="quick-bg-color" ng-click="minder.queryCommandState(\'background\') === -1 || minder.execCommand(\'background\', bgColor)" ng-disabled="minder.queryCommandState(\'background\') === -1"></span> <span color-picker class="bg-color" set-color="setDefaultBg()" ng-disabled="minder.queryCommandState(\'background\') === -1"><span class="caret"></span></span> <span class="bg-color-preview" ng-style="{ \'background-color\': bgColor }" ng-click="minder.queryCommandState(\'background\') === -1 || minder.execCommand(\'background\', bgColor)" ng-disabled="minder.queryCommandState(\'background\') === -1"></span></div>'),e.put("ui/directive/expandLevel/expandLevel.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default expand" title="{{ \'expandtoleaf\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="minder.execCommand(\'ExpandToLevel\', 9999)"></button> <button type="button" class="btn btn-default expand-caption dropdown-toggle" title="{{ \'expandtoleaf\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'expandtoleaf\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'expandtoleaf\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="level in levels"><a href ng-click="minder.execCommand(\'ExpandToLevel\', level)">{{ \'expandtolevel\' + level | lang:\'ui/command\' }}</a></li></ul></div>'),e.put("ui/directive/exportPanel/exportPanel.html",'<div class="km-btn-group export-group"><div class="km-btn-item" ng-click="exportKm()" title="{{ \'export_km\' | lang:\'ui/command\' }}"><i class="km-btn-icon"></i> <span class="km-btn-caption">{{ \'export_km\' | lang:\'ui/command\' }}</span></div><div class="km-btn-item" ng-click="exportPng()" title="{{ \'export_png\' | lang:\'ui/command\' }}"><i class="km-btn-icon"></i> <span class="km-btn-caption">{{ \'export_png\' | lang:\'ui/command\' }}</span></div></div>'),e.put("ui/directive/fontOperator/fontOperator.html",'<div class="font-operator"><div class="dropdown font-family-list" dropdown><div class="dropdown-toggle current-font-item" dropdown-toggle ng-disabled="minder.queryCommandState(\'fontfamily\') === -1"><a href class="current-font-family" title="{{ \'fontfamily\' | lang: \'ui\' }}">{{ getFontfamilyName(minder.queryCommandValue(\'fontfamily\')) || \'\u5b57\u4f53\' }}</a> <span class="caret"></span></div><ul class="dropdown-menu font-list"><li ng-repeat="f in fontFamilyList" class="font-item-wrap"><a ng-click="minder.execCommand(\'fontfamily\', f.val)" class="font-item" ng-class="{ \'font-item-selected\' : f == minder.queryCommandValue(\'fontfamily\') }" ng-style="{\'font-family\': f.val }">{{ f.name }}</a></li></ul></div><div class="dropdown font-size-list" dropdown><div class="dropdown-toggle current-font-item" dropdown-toggle ng-disabled="minder.queryCommandState(\'fontsize\') === -1"><a href class="current-font-size" title="{{ \'fontsize\' | lang: \'ui\' }}">{{ minder.queryCommandValue(\'fontsize\') || \'\u5b57\u53f7\' }}</a> <span class="caret"></span></div><ul class="dropdown-menu font-list"><li ng-repeat="f in fontSizeList" class="font-item-wrap"><a ng-click="minder.execCommand(\'fontsize\', f)" class="font-item" ng-class="{ \'font-item-selected\' : f == minder.queryCommandValue(\'fontsize\') }" ng-style="{\'font-size\': f + \'px\'}">{{ f }}</a></li></ul></div><span class="s-btn-icon font-bold" ng-click="minder.queryCommandState(\'bold\') === -1 || minder.execCommand(\'bold\')" ng-class="{\'font-bold-selected\' : minder.queryCommandState(\'bold\') == 1}" ng-disabled="minder.queryCommandState(\'bold\') === -1"></span> <span class="s-btn-icon font-italics" ng-click="minder.queryCommandState(\'italic\') === -1 || minder.execCommand(\'italic\')" ng-class="{\'font-italics-selected\' : minder.queryCommandState(\'italic\') == 1}" ng-disabled="minder.queryCommandState(\'italic\') === -1"></span><div class="font-color-wrap"><span class="quick-font-color" ng-click="minder.queryCommandState(\'forecolor\') === -1 || minder.execCommand(\'forecolor\', foreColor)" ng-disabled="minder.queryCommandState(\'forecolor\') === -1">A</span> <span color-picker class="font-color" set-color="setDefaultColor()" ng-disabled="minder.queryCommandState(\'forecolor\') === -1"><span class="caret"></span></span> <span class="font-color-preview" ng-style="{ \'background-color\': foreColor }" ng-click="minder.queryCommandState(\'forecolor\') === -1 || minder.execCommand(\'forecolor\', foreColor)" ng-disabled="minder.queryCommandState(\'forecolor\') === -1"></span></div><color-panel minder="minder" class="inline-directive"></color-panel></div>'),e.put("ui/directive/hyperLink/hyperLink.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default hyperlink" title="{{ \'link\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addHyperlink()" ng-disabled="minder.queryCommandState(\'HyperLink\') === -1"></button> <button type="button" class="btn btn-default hyperlink-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'HyperLink\') === -1" title="{{ \'link\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'link\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'link\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addHyperlink()">{{ \'insertlink\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'HyperLink\', null)">{{ \'removelink\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/imageBtn/imageBtn.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default image-btn" title="{{ \'image\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addImage()" ng-disabled="minder.queryCommandState(\'Image\') === -1"></button> <button type="button" class="btn btn-default image-btn-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'Image\') === -1" title="{{ \'image\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'image\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'image\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addImage()">{{ \'insertimage\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'Image\', \'\')">{{ \'removeimage\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/kityminderEditor/kityminderEditor.html",'<div class="minder-editor-container"><div class="top-tab" top-tab="minder" editor="editor" ng-if="minder"></div><div search-box minder="minder" ng-if="minder"></div><export-btn minder="minder" ng-if="minder"></export-btn><markdown-import minder="minder" ng-if="minder"></markdown-import><div class="minder-editor"></div><div class="km-note" note-editor minder="minder" ng-if="minder"></div><div class="note-previewer" note-previewer ng-if="minder"></div><div class="navigator" navigator minder="minder" ng-if="minder"></div></div>'),e.put("ui/directive/kityminderViewer/kityminderViewer.html",'<div class="minder-editor-container"><div class="minder-viewer"></div><div class="note-previewer" note-previewer ng-if="minder"></div><div class="navigator" navigator minder="minder" ng-if="minder"></div></div>'),e.put("ui/directive/layout/layout.html",'<div class="readjust-layout"><a ng-click="minder.queryCommandState(\'resetlayout\') === -1 || minder.execCommand(\'resetlayout\')" class="btn-wrap" ng-disabled="minder.queryCommandState(\'resetlayout\') === -1"><span class="btn-icon reset-layout-icon"></span> <span class="btn-label">{{ \'resetlayout\' | lang: \'ui/command\' }}</span></a></div>'),e.put("ui/directive/markdownImport/markdownImport.html",'<div class="markdown-import"><div class="markdown-editor"><textarea ng-model="markdownContent" ng-change="convertToMindmap()" placeholder="\u8bf7\u8f93\u5165 Markdown \u6587\u672c..."></textarea></div><div class="markdown-toolbar"><button class="btn btn-default" ng-click="clearMarkdown()">\u6e05\u7a7a</button></div><div class="ai-chat-section"><div class="model-selector"><select ng-model="selectedModel" ng-change="onModelChange()" class="form-control"><option value="">\u9009\u62e9\u5927\u6a21\u578b</option><option ng-repeat="model in modelList" value="{{model.name}}">{{model.name}}</option></select></div><div class="chat-area" ng-show="selectedModel"><div class="chat-messages" id="chatMessages"><div ng-repeat="message in chatMessages" class="message" ng-class="message.role"><div class="message-content">{{message.content}}</div></div></div><div class="chat-input"><textarea ng-model="userMessage" placeholder="\u8f93\u5165\u6d88\u606f..." class="form-control"></textarea><button class="btn btn-primary" ng-click="sendMessage()" ng-disabled="!userMessage">\u53d1\u9001</button></div></div></div></div>'),e.put("ui/directive/navigator/navigator.html",'<div class="nav-bar"><div class="nav-btn zoom-in" ng-click="minder.execCommand(\'zoomIn\')" title="{{ \'zoom-in\' | lang : \'ui\' }}" ng-class="{ \'active\' : getZoomRadio(zoom) == 0 }"><div class="icon"></div></div><div class="zoom-pan"><div class="origin" ng-style="{\'transform\': \'translate(0, \' + getHeight(100) + \'px)\'}" ng-click="minder.execCommand(\'zoom\', 100);"></div><div class="indicator" ng-style="{\n             \'transform\': \'translate(0, \' + getHeight(zoom) + \'px)\',\n             \'transition\': \'transform 200ms\'\n             }"></div></div><div class="nav-btn zoom-out" ng-click="minder.execCommand(\'zoomOut\')" title="{{ \'zoom-out\' | lang : \'ui\' }}" ng-class="{ \'active\' : getZoomRadio(zoom) == 1 }"><div class="icon"></div></div><div class="nav-btn hand" ng-click="minder.execCommand(\'hand\')" title="{{ \'hand\' | lang : \'ui\' }}" ng-class="{ \'active\' : minder.queryCommandState(\'hand\') == 1 }"><div class="icon"></div></div><div class="nav-btn camera" ng-click="minder.execCommand(\'camera\', minder.getRoot(), 600);" title="{{ \'camera\' | lang : \'ui\' }}"><div class="icon"></div></div><div class="nav-btn nav-trigger" ng-class="{\'active\' : isNavOpen}" ng-click="toggleNavOpen()" title="{{ \'navigator\' | lang : \'ui\' }}"><div class="icon"></div></div></div><div class="nav-previewer" ng-show="isNavOpen"></div>'),e.put("ui/directive/noteBtn/noteBtn.html",'<div class="btn-group-vertical note-btn-group" dropdown is-open="isopen"><button type="button" class="btn btn-default note-btn" title="{{ \'note\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="addNote()" ng-disabled="minder.queryCommandState(\'note\') === -1"></button> <button type="button" class="btn btn-default note-btn-caption dropdown-toggle" ng-disabled="minder.queryCommandState(\'note\') === -1" title="{{ \'note\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'note\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'note\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li><a href ng-click="addNote()">{{ \'insertnote\' | lang:\'ui\' }}</a></li><li><a href ng-click="minder.execCommand(\'note\', null)">{{ \'removenote\' | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/noteEditor/noteEditor.html",'<div class="panel panel-default" ng-init="noteEditorOpen = false" ng-show="noteEditorOpen"><div class="panel-heading"><h3 class="panel-title">\u5907\u6ce8</h3><span>\uff08<a class="help" href="https://www.zybuluo.com/techird/note/46064" target="_blank">\u652f\u6301 GFM \u8bed\u6cd5\u4e66\u5199</a>\uff09</span> <i class="close-note-editor glyphicon glyphicon-remove" ng-click="closeNoteEditor()"></i></div><div class="panel-body"><div ng-show="noteEnabled" ui-codemirror="{ onLoad: codemirrorLoaded }" ng-model="noteContent" ui-codemirror-opts="{\n                gfm: true,\n                breaks: true,\n                lineWrapping : true,\n                mode: \'gfm\',\n                dragDrop: false,\n                lineNumbers:true\n             }"></div><p ng-show="!noteEnabled" class="km-note-tips">\u8bf7\u9009\u62e9\u8282\u70b9\u7f16\u8f91\u5907\u6ce8</p></div></div>'),e.put("ui/directive/notePreviewer/notePreviewer.html",'<div id="previewer-content" ng-show="showNotePreviewer" ng-style="previewerStyle" ng-bind-html="noteContent"></div>'),e.put("ui/directive/operation/operation.html","<div class=\"km-btn-group operation-group\"><div class=\"km-btn-item edit-node\" ng-disabled=\"minder.queryCommandState('text') === -1\" ng-click=\"minder.queryCommandState('text') === -1 || editNode()\" title=\"{{ 'editnode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'editnode' | lang:'ui/command' }}</span></div><div class=\"km-btn-item remove-node\" ng-disabled=\"minder.queryCommandState('RemoveNode') === -1\" ng-click=\"minder.queryCommandState('RemoveNode') === -1 || minder.execCommand('RemoveNode');\" title=\"{{ 'removenode' | lang:'ui/command' }}\"><i class=\"km-btn-icon\"></i> <span class=\"km-btn-caption\">{{ 'removenode' | lang:'ui/command' }}</span></div></div>"),e.put("ui/directive/priorityEditor/priorityEditor.html",'<ul class="km-priority tool-group" ng-disabled="commandDisabled"><li class="km-priority-item tool-group-item" ng-repeat="p in priorities" ng-click="commandDisabled || minder.execCommand(\'priority\', p)" ng-class="{ active: commandValue == p }" title="{{ getPriorityTitle(p) }}"><div class="km-priority-icon tool-group-icon priority-{{p}}"></div></li></ul>'),e.put("ui/directive/progressEditor/progressEditor.html",'<ul class="km-progress tool-group" ng-disabled="commandDisabled"><li class="km-progress-item tool-group-item" ng-repeat="p in progresses" ng-click="commandDisabled || minder.execCommand(\'progress\', p)" ng-class="{ active: commandValue == p }" title="{{ getProgressTitle(p) }}"><div class="km-progress-icon tool-group-icon progress-{{p}}"></div></li></ul>'),e.put("ui/directive/resourceEditor/resourceEditor.html",'<div class="resource-editor"><div class="input-group"><input class="form-control" type="text" ng-model="newResourceName" ng-required ng-keypress="$event.keyCode == 13 && addResource(newResourceName)" ng-disabled="!enabled"> <span class="input-group-btn"><button class="btn btn-default" ng-click="addResource(newResourceName)" ng-disabled="!enabled">\u6dfb\u52a0</button></span></div><div class="resource-dropdown clearfix" id="resource-dropdown"><ul class="km-resource" ng-init="resourceListOpen = false" ng-class="{\'open\': resourceListOpen}"><li ng-repeat="resource in used" ng-disabled="!enabled" ng-blur="blurCB()"><label style="background: {{resourceColor(resource.name)}}"><input type="checkbox" ng-model="resource.selected" ng-disabled="!enabled"> <span>{{resource.name}}</span></label></li></ul><div class="resource-caret" click-anywhere-but-here="resourceListOpen = false" is-active="resourceListOpen" ng-click="resourceListOpen = !resourceListOpen"><span class="caret"></span></div></div></div>'),e.put("ui/directive/searchBox/searchBox.html",'<div id="search" class="search-box clearfix" ng-show="showSearch"><div class="input-group input-group-sm search-input-wrap"><input type="text" id="search-input" class="form-control search-input" ng-model="keyword" ng-keydown="handleKeyDown($event)" aria-describedby="basic-addon2"> <span class="input-group-addon search-addon" id="basic-addon2" ng-show="showTip" ng-bind="\'\u7b2c \' + curIndex + \' \u6761\uff0c\u5171 \' + resultNum + \' \u6761\'"></span></div><div class="btn-group btn-group-sm prev-and-next-btn" role="group"><button type="button" class="btn btn-default" ng-click="doSearch(keyword, \'prev\')"><span class="glyphicon glyphicon-chevron-up"></span></button> <button type="button" class="btn btn-default" ng-click="doSearch(keyword, \'next\')"><span class="glyphicon glyphicon-chevron-down"></span></button></div><div class="close-search" ng-click="exitSearch()"><span class="glyphicon glyphicon-remove"></span></div></div>'),e.put("ui/directive/searchBtn/searchBtn.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default search" title="{{ \'search\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="enterSearch()"></button> <button type="button" class="btn btn-default search-caption dropdown-toggle" ng-click="enterSearch()" title="{{ \'search\' | lang:\'ui\' }}"><span class="caption">{{ \'search\' | lang:\'ui\' }}</span> <span class="sr-only">{{ \'search\' | lang:\'ui\' }}</span></button></div>'),e.put("ui/directive/selectAll/selectAll.html",'<div class="btn-group-vertical" dropdown is-open="isopen"><button type="button" class="btn btn-default select" title="{{ \'selectall\' | lang:\'ui\' }}" ng-class="{\'active\': isopen}" ng-click="select[\'all\']()"></button> <button type="button" class="btn btn-default select-caption dropdown-toggle" title="{{ \'selectall\' | lang:\'ui\' }}" dropdown-toggle><span class="caption">{{ \'selectall\' | lang:\'ui\' }}</span> <span class="caret"></span> <span class="sr-only">{{ \'selectall\' | lang:\'ui\' }}</span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="item in items"><a href ng-click="select[item]()">{{ \'select\' + item | lang:\'ui\' }}</a></li></ul></div>'),e.put("ui/directive/styleOperator/styleOperator.html",'<div class="style-operator"><a ng-click="minder.queryCommandState(\'clearstyle\') === -1 || minder.execCommand(\'clearstyle\')" class="btn-wrap clear-style" ng-disabled="minder.queryCommandState(\'clearstyle\') === -1"><span class="btn-icon clear-style-icon"></span> <span class="btn-label">{{ \'clearstyle\' | lang: \'ui\' }}</span></a><div class="s-btn-group-vertical"><a class="s-btn-wrap" href ng-click="minder.queryCommandState(\'copystyle\') === -1 || minder.execCommand(\'copystyle\')" ng-disabled="minder.queryCommandState(\'copystyle\') === -1"><span class="s-btn-icon copy-style-icon"></span> <span class="s-btn-label">{{ \'copystyle\' | lang: \'ui\' }}</span></a> <a class="s-btn-wrap paste-style-wrap" href ng-click="minder.queryCommandState(\'pastestyle\') === -1 || minder.execCommand(\'pastestyle\')" ng-disabled="minder.queryCommandState(\'pastestyle\') === -1"><span class="s-btn-icon paste-style-icon"></span> <span class="s-btn-label">{{ \'pastestyle\' | lang: \'ui\' }}</span></a></div></div>'),e.put("ui/directive/templateList/templateList.html",'<div class="dropdown temp-panel" dropdown on-toggle="toggled(open)"><div class="dropdown-toggle current-temp-item" ng-disabled="minder.queryCommandState(\'template\') === -1" dropdown-toggle><a href class="temp-item {{ minder.queryCommandValue(\'template\') }}" title="{{ minder.queryCommandValue(\'template\') | lang: \'template\' }}"></a> <span class="caret"></span></div><ul class="dropdown-menu temp-list"><li ng-repeat="(key, templateObj) in templateList" class="temp-item-wrap"><a ng-click="minder.execCommand(\'template\', key);" class="temp-item {{key}}" ng-class="{ \'temp-item-selected\' : key == minder.queryCommandValue(\'template\') }" title="{{ key | lang: \'template\' }}"></a></li></ul></div>'),e.put("ui/directive/themeList/themeList.html",'<div class="dropdown theme-panel" dropdown><div class="dropdown-toggle theme-item-selected" dropdown-toggle ng-disabled="minder.queryCommandState(\'theme\') === -1"><a href class="theme-item" ng-style="getThemeThumbStyle(minder.queryCommandValue(\'theme\'))" title="{{ minder.queryCommandValue(\'theme\') | lang: \'theme\'; }}">{{ minder.queryCommandValue(\'theme\') | lang: \'theme\'; }}</a> <span class="caret"></span></div><ul class="dropdown-menu theme-list"><li ng-repeat="key in themeKeyList" class="theme-item-wrap"><a ng-click="minder.execCommand(\'theme\', key);" class="theme-item" ng-style="getThemeThumbStyle(key)" title="{{ key | lang: \'theme\'; }}">{{ key | lang: \'theme\'; }}</a></li></ul></div>'),e.put("ui/directive/topTab/topTab.html",'<tabset><tab heading="{{ \'idea\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'idea\')" select="setCurTab(\'idea\')"><undo-redo editor="editor"></undo-redo><append-node minder="minder"></append-node><arrange minder="minder"></arrange><operation minder="minder"></operation><hyper-link minder="minder"></hyper-link><image-btn minder="minder"></image-btn><note-btn minder="minder"></note-btn><priority-editor minder="minder"></priority-editor><progress-editor minder="minder"></progress-editor><resource-editor minder="minder"></resource-editor></tab><tab heading="{{ \'appearence\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'appearance\')" select="setCurTab(\'appearance\')"><template-list minder="minder" class="inline-directive"></template-list><theme-list minder="minder"></theme-list><layout minder="minder" class="inline-directive"></layout><style-operator minder="minder" class="inline-directive"></style-operator><font-operator minder="minder" class="inline-directive"></font-operator></tab><tab heading="{{ \'view\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'view\')" select="setCurTab(\'view\')"><expand-level minder="minder"></expand-level><select-all minder="minder"></select-all><search-btn minder="minder"></search-btn></tab><tab heading="{{ \'export\' | lang: \'ui/tabs\'; }}" ng-click="toggleTopTab(\'export\')" select="setCurTab(\'export\')"><export-panel minder="minder"></export-panel></tab></tabset>'),e.put("ui/directive/undoRedo/undoRedo.html",'<div class="km-btn-group do-group"><div class="km-btn-item undo" ng-disabled="editor.history.hasUndo() == false" ng-click="editor.history.hasUndo() == false || editor.history.undo();" title="{{ \'undo\' | lang:\'ui\' }}"><i class="km-btn-icon"></i></div><div class="km-btn-item redo" ng-disabled="editor.history.hasRedo() == false" ng-click="editor.history.hasRedo() == false || editor.history.redo()" title="{{ \'redo\' | lang:\'ui\' }}"><i class="km-btn-icon"></i></div></div>'),e.put("ui/dialog/hyperlink/hyperlink.tpl.html",'<div class="modal-header"><h3 class="modal-title">\u94fe\u63a5</h3></div><div class="modal-body"><form><div class="form-group" id="link-url-wrap" ng-class="{true: \'has-success\', false: \'has-error\'}[urlPassed]"><label for="link-url">\u94fe\u63a5\u5730\u5740\uff1a</label><input type="text" class="form-control" ng-model="url" ng-blur="urlPassed = R_URL.test(url)" ng-focus="this.value = url" ng-keydown="shortCut($event)" id="link-url" placeholder="\u5fc5\u586b\uff1a\u4ee5 http(s):// \u6216 ftp:// \u5f00\u5934"></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="link-title">\u63d0\u793a\u6587\u672c\uff1a</label><input type="text" class="form-control" ng-model="title" ng-blur="titlePassed = true" id="link-title" placeholder="\u9009\u586b\uff1a\u9f20\u6807\u5728\u94fe\u63a5\u4e0a\u60ac\u505c\u65f6\u63d0\u793a\u7684\u6587\u672c"></div></form></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">\u786e\u5b9a</button> <button class="btn btn-warning" ng-click="cancel()">\u53d6\u6d88</button></div>'),e.put("ui/dialog/imExportNode/imExportNode.tpl.html",'<div class="modal-header"><h3 class="modal-title">{{ title }}</h3></div><div class="modal-body"><textarea type="text" class="form-control single-input" rows="8" ng-keydown="shortCut($event);" ng-model="value" ng-readonly="type === \'export\'">\n    </textarea></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()" ng-disabled="type === \'import\' && value == \'\'">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),e.put("ui/dialog/image/image.tpl.html",'<div class="modal-header"><h3 class="modal-title">\u56fe\u7247</h3></div><div class="modal-body"><tabset><tab heading="\u56fe\u7247\u641c\u7d22"><form class="form-inline"><div class="form-group"><label for="search-keyword">\u5173\u952e\u8bcd\uff1a</label><input type="text" class="form-control" ng-model="data.searchKeyword2" id="search-keyword" placeholder="\u8bf7\u8f93\u5165\u641c\u7d22\u7684\u5173\u952e\u8bcd"></div><button class="btn btn-primary" ng-click="searchImage()">\u767e\u5ea6\u4e00\u4e0b</button></form><div class="search-result" id="search-result"><ul><li ng-repeat="image in list" id="{{ \'img-item\' + $index }}" ng-class="{\'selected\' : isSelected}" ng-click="selectImage($event)"><img id="{{ \'img-\' + $index }}" ng-src="{{ image.src || \'\' }}" alt="{{ image.title }}" onerror="this.parentNode.removeChild(this)"> <span>{{ image.title }}</span></li></ul></div></tab><tab heading="\u5916\u94fe\u56fe\u7247"><form><div class="form-group" ng-class="{true: \'has-success\', false: \'has-error\'}[urlPassed]"><label for="image-url">\u94fe\u63a5\u5730\u5740\uff1a</label><input type="text" class="form-control" ng-model="data.url" ng-blur="urlPassed = data.R_URL.test(data.url)" ng-focus="this.value = data.url" ng-keydown="shortCut($event)" id="image-url" placeholder="\u5fc5\u586b\uff1a\u4ee5 http(s):// \u5f00\u5934"></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="image-title">\u63d0\u793a\u6587\u672c\uff1a</label><input type="text" class="form-control" ng-model="data.title" ng-blur="titlePassed = true" id="image-title" placeholder="\u9009\u586b\uff1a\u9f20\u6807\u5728\u56fe\u7247\u4e0a\u60ac\u505c\u65f6\u63d0\u793a\u7684\u6587\u672c"></div><div class="form-group"><label for="image-preview">\u56fe\u7247\u9884\u89c8\uff1a</label><img class="image-preview" id="image-preview" ng-src="{{ data.url }}" alt="{{ data.title }}"></div></form></tab><tab heading="\u4e0a\u4f20\u56fe\u7247" active="true"><form><div class="form-group"><input type="file" name="upload-image" id="upload-image" class="upload-image" accept=".jpg,.JPG,jpeg,JPEG,.png,.PNG,.gif,.GIF" onchange="angular.element(this).scope().uploadImage()"><label for="upload-image" class="btn btn-primary"><span>\u9009\u62e9\u6587\u4ef6&hellip;</span></label></div><div class="form-group" ng-class="{\'has-success\' : titlePassed}"><label for="image-title">\u63d0\u793a\u6587\u672c\uff1a</label><input type="text" class="form-control" ng-model="data.title" ng-blur="titlePassed = true" id="image-title" placeholder="\u9009\u586b\uff1a\u9f20\u6807\u5728\u56fe\u7247\u4e0a\u60ac\u505c\u65f6\u63d0\u793a\u7684\u6587\u672c"></div><div class="form-group"><label for="image-preview">\u56fe\u7247\u9884\u89c8\uff1a</label><img class="image-preview" id="image-preview" ng-src="{{ data.url }}" title="{{ data.title }}" alt="{{ data.title }}"></div></form></tab></tabset></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">\u786e\u5b9a</button> <button class="btn btn-warning" ng-click="cancel()">\u53d6\u6d88</button></div>')}]),angular.module("kityminderEditor").service("commandBinder",function(){return{bind:function(e,t,n){e.on("interactchange",function(){n.commandDisabled=-1===e.queryCommandState(t),n.commandValue=e.queryCommandValue(t),n.$apply()})}}}),angular.module("kityminderEditor").provider("config",function(){this.config={ctrlPanelMin:250,ctrlPanelWidth:parseInt(window.localStorage.__dev_minder_ctrlPanelWidth)||250,dividerWidth:3,defaultLang:"zh-cn",zoom:[10,20,30,50,80,100,120,150,200],imageUpload:"server/imageUpload.php"},this.set=function(e,t){var n=Object.keys(this.config),r={};for(var i in"object"==typeof e?r=e:r[e]=t,r){if(!r.hasOwnProperty(i)||-1===n.indexOf(i))return console.error("Unsupported config key: ",e,", please choose in :",n.join(", ")),!1;this.config[i]=r[i]}return!0},this.$get=function(){var t=this;return{get:function(e){return 0===arguments.length?t.config:t.config.hasOwnProperty(e)?t.config[e]:(console.warn("Missing config key pair for : ",e),"")}}}}),angular.module("kityminderEditor").service("lang.zh-cn",function(){return{"zh-cn":{template:{"default":"\u601d\u7ef4\u5bfc\u56fe",tianpan:"\u5929\u76d8\u56fe",structure:"\u7ec4\u7ec7\u7ed3\u6784\u56fe",filetree:"\u76ee\u5f55\u7ec4\u7ec7\u56fe",right:"\u903b\u8f91\u7ed3\u6784\u56fe","fish-bone":"\u9c7c\u9aa8\u5934\u56fe"},theme:{classic:"\u8111\u56fe\u7ecf\u5178","classic-compact":"\u7d27\u51d1\u7ecf\u5178",snow:"\u6e29\u67d4\u51b7\u5149","snow-compact":"\u7d27\u51d1\u51b7\u5149",fish:"\u9c7c\u9aa8\u56fe",wire:"\u7ebf\u6846","fresh-red":"\u6e05\u65b0\u7ea2","fresh-soil":"\u6ce5\u571f\u9ec4","fresh-green":"\u6587\u827a\u7eff","fresh-blue":"\u5929\u7a7a\u84dd","fresh-purple":"\u6d6a\u6f2b\u7d2b","fresh-pink":"\u8111\u6b8b\u7c89","fresh-red-compat":"\u7d27\u51d1\u7ea2","fresh-soil-compat":"\u7d27\u51d1\u9ec4","fresh-green-compat":"\u7d27\u51d1\u7eff","fresh-blue-compat":"\u7d27\u51d1\u84dd","fresh-purple-compat":"\u7d27\u51d1\u7d2b","fresh-pink-compat":"\u7d27\u51d1\u7c89",tianpan:"\u7ecf\u5178\u5929\u76d8","tianpan-compact":"\u7d27\u51d1\u5929\u76d8"},maintopic:"\u4e2d\u5fc3\u4e3b\u9898",topic:"\u5206\u652f\u4e3b\u9898",panels:{history:"\u5386\u53f2",template:"\u6a21\u677f",theme:"\u76ae\u80a4",layout:"\u5e03\u5c40",style:"\u6837\u5f0f",font:"\u6587\u5b57",color:"\u989c\u8272",background:"\u80cc\u666f",insert:"\u63d2\u5165",arrange:"\u8c03\u6574",nodeop:"\u5f53\u524d",priority:"\u4f18\u5148\u7ea7",progress:"\u8fdb\u5ea6",resource:"\u8d44\u6e90",note:"\u5907\u6ce8",attachment:"\u9644\u4ef6",word:"\u6587\u5b57"},error_message:{title:"\u54ce\u5440\uff0c\u8111\u56fe\u51fa\u9519\u4e86",err_load:"\u52a0\u8f7d\u8111\u56fe\u5931\u8d25",err_save:"\u4fdd\u5b58\u8111\u56fe\u5931\u8d25",err_network:"\u7f51\u7edc\u9519\u8bef",err_doc_resolve:"\u6587\u6863\u89e3\u6790\u5931\u8d25",err_unknown:"\u53d1\u751f\u4e86\u5947\u602a\u7684\u9519\u8bef",err_localfile_read:"\u6587\u4ef6\u8bfb\u53d6\u9519\u8bef",err_download:"\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25",err_remove_share:"\u53d6\u6d88\u5206\u4eab\u5931\u8d25",err_create_share:"\u5206\u4eab\u5931\u8d25",err_mkdir:"\u76ee\u5f55\u521b\u5efa\u5931\u8d25",err_ls:"\u8bfb\u53d6\u76ee\u5f55\u5931\u8d25",err_share_data:"\u52a0\u8f7d\u5206\u4eab\u5185\u5bb9\u51fa\u9519",err_share_sync_fail:"\u5206\u4eab\u5185\u5bb9\u540c\u6b65\u5931\u8d25",err_move_file:"\u6587\u4ef6\u79fb\u52a8\u5931\u8d25",err_rename:"\u91cd\u547d\u540d\u5931\u8d25",unknownreason:"\u53ef\u80fd\u662f\u5916\u661f\u4eba\u7be1\u6539\u4e86\u4ee3\u7801...",pcs_code:{3:"\u4e0d\u652f\u6301\u6b64\u63a5\u53e3",4:"\u6ca1\u6709\u6743\u9650\u6267\u884c\u6b64\u64cd\u4f5c",5:"IP\u672a\u6388\u6743",110:"\u7528\u6237\u4f1a\u8bdd\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",31001:"\u6570\u636e\u5e93\u67e5\u8be2\u9519\u8bef",31002:"\u6570\u636e\u5e93\u8fde\u63a5\u9519\u8bef",31003:"\u6570\u636e\u5e93\u8fd4\u56de\u7a7a\u7ed3\u679c",31021:"\u7f51\u7edc\u9519\u8bef",31022:"\u6682\u65f6\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668",31023:"\u8f93\u5165\u53c2\u6570\u9519\u8bef",31024:"app id\u4e3a\u7a7a",31025:"\u540e\u7aef\u5b58\u50a8\u9519\u8bef",31041:"\u7528\u6237\u7684cookie\u4e0d\u662f\u5408\u6cd5\u7684\u767e\u5ea6cookie",31042:"\u7528\u6237\u672a\u767b\u9646",31043:"\u7528\u6237\u672a\u6fc0\u6d3b",31044:"\u7528\u6237\u672a\u6388\u6743",31045:"\u7528\u6237\u4e0d\u5b58\u5728",31046:"\u7528\u6237\u5df2\u7ecf\u5b58\u5728",31061:"\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728",31062:"\u6587\u4ef6\u540d\u975e\u6cd5",31063:"\u6587\u4ef6\u7236\u76ee\u5f55\u4e0d\u5b58\u5728",31064:"\u65e0\u6743\u8bbf\u95ee\u6b64\u6587\u4ef6",31065:"\u76ee\u5f55\u5df2\u6ee1",31066:"\u6587\u4ef6\u4e0d\u5b58\u5728",31067:"\u6587\u4ef6\u5904\u7406\u51fa\u9519",31068:"\u6587\u4ef6\u521b\u5efa\u5931\u8d25",31069:"\u6587\u4ef6\u62f7\u8d1d\u5931\u8d25",31070:"\u6587\u4ef6\u5220\u9664\u5931\u8d25",31071:"\u4e0d\u80fd\u8bfb\u53d6\u6587\u4ef6\u5143\u4fe1\u606f",31072:"\u6587\u4ef6\u79fb\u52a8\u5931\u8d25",31073:"\u6587\u4ef6\u91cd\u547d\u540d\u5931\u8d25",31079:"\u672a\u627e\u5230\u6587\u4ef6MD5\uff0c\u8bf7\u4f7f\u7528\u4e0a\u4f20API\u4e0a\u4f20\u6574\u4e2a\u6587\u4ef6\u3002",31081:"superfile\u521b\u5efa\u5931\u8d25",31082:"superfile \u5757\u5217\u8868\u4e3a\u7a7a",31083:"superfile \u66f4\u65b0\u5931\u8d25",31101:"tag\u7cfb\u7edf\u5185\u90e8\u9519\u8bef",31102:"tag\u53c2\u6570\u9519\u8bef",31103:"tag\u7cfb\u7edf\u9519\u8bef",31110:"\u672a\u6388\u6743\u8bbe\u7f6e\u6b64\u76ee\u5f55\u914d\u989d",31111:"\u914d\u989d\u7ba1\u7406\u53ea\u652f\u6301\u4e24\u7ea7\u76ee\u5f55",31112:"\u8d85\u51fa\u914d\u989d",31113:"\u914d\u989d\u4e0d\u80fd\u8d85\u51fa\u76ee\u5f55\u7956\u5148\u7684\u914d\u989d",31114:"\u914d\u989d\u4e0d\u80fd\u6bd4\u5b50\u76ee\u5f55\u914d\u989d\u5c0f",31141:"\u8bf7\u6c42\u7f29\u7565\u56fe\u670d\u52a1\u5931\u8d25",31201:"\u7b7e\u540d\u9519\u8bef",31202:"\u6587\u4ef6\u4e0d\u5b58\u5728",31203:"\u8bbe\u7f6eacl\u5931\u8d25",31204:"\u8bf7\u6c42acl\u9a8c\u8bc1\u5931\u8d25",31205:"\u83b7\u53d6acl\u5931\u8d25",31206:"acl\u4e0d\u5b58\u5728",31207:"bucket\u5df2\u5b58\u5728",31208:"\u7528\u6237\u8bf7\u6c42\u9519\u8bef",31209:"\u670d\u52a1\u5668\u9519\u8bef",31210:"\u670d\u52a1\u5668\u4e0d\u652f\u6301",31211:"\u7981\u6b62\u8bbf\u95ee",31212:"\u670d\u52a1\u4e0d\u53ef\u7528",31213:"\u91cd\u8bd5\u51fa\u9519",31214:"\u4e0a\u4f20\u6587\u4ef6data\u5931\u8d25",31215:"\u4e0a\u4f20\u6587\u4ef6meta\u5931\u8d25",31216:"\u4e0b\u8f7d\u6587\u4ef6data\u5931\u8d25",31217:"\u4e0b\u8f7d\u6587\u4ef6meta\u5931\u8d25",31218:"\u5bb9\u91cf\u8d85\u51fa\u9650\u989d",31219:"\u8bf7\u6c42\u6570\u8d85\u51fa\u9650\u989d",31220:"\u6d41\u91cf\u8d85\u51fa\u9650\u989d",31298:"\u670d\u52a1\u5668\u8fd4\u56de\u503cKEY\u975e\u6cd5",31299:"\u670d\u52a1\u5668\u8fd4\u56de\u503cKEY\u4e0d\u5b58\u5728"}},ui:{shared_file_title:"[\u5206\u4eab\u7684] {0} (\u53ea\u8bfb)",load_share_for_edit:"\u6b63\u5728\u52a0\u8f7d\u5206\u4eab\u7684\u6587\u4ef6...",share_sync_success:"\u5206\u4eab\u5185\u5bb9\u5df2\u540c\u6b65",recycle_clear_confirm:"\u786e\u8ba4\u6e05\u7a7a\u56de\u6536\u7ad9\u4e48\uff1f\u6e05\u7a7a\u540e\u7684\u6587\u4ef6\u65e0\u6cd5\u6062\u590d\u3002",fullscreen_exit_hint:"\u6309 Esc \u6216 F11 \u9000\u51fa\u5168\u5c4f",error_detail:"\u8be6\u7ec6\u4fe1\u606f",copy_and_feedback:"\u590d\u5236\u5e76\u53cd\u9988",move_file_confirm:'\u786e\u5b9a\u628a "{0}" \u79fb\u52a8\u5230 "{1}" \u5417\uff1f',rename:"\u91cd\u547d\u540d",rename_success:"{0} \u91cd\u547d\u540d\u6210\u529f",move_success:"{0} \u79fb\u52a8\u6210\u529f\u5230 {1}",command:{appendsiblingnode:"\u63d2\u5165\u540c\u7ea7\u4e3b\u9898",appendparentnode:"\u63d2\u5165\u4e0a\u7ea7\u4e3b\u9898",appendchildnode:"\u63d2\u5165\u4e0b\u7ea7\u4e3b\u9898",removenode:"\u5220\u9664",editnode:"\u7f16\u8f91",arrangeup:"\u4e0a\u79fb",arrangedown:"\u4e0b\u79fb",resetlayout:"\u6574\u7406\u5e03\u5c40",expandtoleaf:"\u5c55\u5f00\u5168\u90e8\u8282\u70b9",expandtolevel1:"\u5c55\u5f00\u5230\u4e00\u7ea7\u8282\u70b9",expandtolevel2:"\u5c55\u5f00\u5230\u4e8c\u7ea7\u8282\u70b9",expandtolevel3:"\u5c55\u5f00\u5230\u4e09\u7ea7\u8282\u70b9",expandtolevel4:"\u5c55\u5f00\u5230\u56db\u7ea7\u8282\u70b9",expandtolevel5:"\u5c55\u5f00\u5230\u4e94\u7ea7\u8282\u70b9",expandtolevel6:"\u5c55\u5f00\u5230\u516d\u7ea7\u8282\u70b9",fullscreen:"\u5168\u5c4f",outline:"\u5927\u7eb2",export_km:"\u5bfc\u51fa.km",export_png:"\u5bfc\u51fa.png"},search:"\u641c\u7d22",expandtoleaf:"\u5c55\u5f00",back:"\u8fd4\u56de",undo:"\u64a4\u9500 (Ctrl + Z)",redo:"\u91cd\u505a (Ctrl + Y)",tabs:{idea:"\u601d\u8def",appearence:"\u5916\u89c2",view:"\u89c6\u56fe","export":"\u5bfc\u51fa"},quickvisit:{"new":"\u65b0\u5efa (Ctrl + Alt + N)",save:"\u4fdd\u5b58 (Ctrl + S)",share:"\u5206\u4eab (Ctrl + Alt + S)",feedback:"\u53cd\u9988\u95ee\u9898\uff08F1\uff09",editshare:"\u7f16\u8f91"},menu:{mainmenutext:"\u767e\u5ea6\u8111\u56fe",newtab:"\u65b0\u5efa",opentab:"\u6253\u5f00",savetab:"\u4fdd\u5b58",sharetab:"\u5206\u4eab",preferencetab:"\u8bbe\u7f6e",helptab:"\u5e2e\u52a9",feedbacktab:"\u53cd\u9988",recenttab:"\u6700\u8fd1\u4f7f\u7528",netdisktab:"\u767e\u5ea6\u4e91\u5b58\u50a8",localtab:"\u672c\u5730\u6587\u4ef6",drafttab:"\u8349\u7a3f\u7bb1",downloadtab:"\u5bfc\u51fa\u5230\u672c\u5730",createsharetab:"\u5f53\u524d\u8111\u56fe",managesharetab:"\u5df2\u5206\u4eab",newheader:"\u65b0\u5efa\u8111\u56fe",openheader:"\u6253\u5f00",saveheader:"\u4fdd\u5b58\u5230",draftheader:"\u8349\u7a3f\u7bb1",shareheader:"\u5206\u4eab\u6211\u7684\u8111\u56fe",downloadheader:"\u5bfc\u51fa\u5230\u6307\u5b9a\u683c\u5f0f",preferenceheader:"\u504f\u597d\u8bbe\u7f6e",helpheader:"\u5e2e\u52a9",feedbackheader:"\u53cd\u9988"},mydocument:"\u6211\u7684\u6587\u6863",emptydir:"\u76ee\u5f55\u4e3a\u7a7a\uff01",pickfile:"\u9009\u62e9\u6587\u4ef6...",acceptfile:"\u652f\u6301\u7684\u683c\u5f0f\uff1a{0}",dropfile:"\u6216\u5c06\u6587\u4ef6\u62d6\u81f3\u6b64\u5904",unsupportedfile:"\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u683c\u5f0f",untitleddoc:"\u672a\u547d\u540d\u6587\u6863",overrideconfirm:"{0} \u5df2\u5b58\u5728\uff0c\u786e\u8ba4\u8986\u76d6\u5417\uff1f",checklogin:"\u68c0\u67e5\u767b\u5f55\u72b6\u6001\u4e2d...",loggingin:"\u6b63\u5728\u767b\u5f55...",recent:"\u6700\u8fd1\u6253\u5f00",clearrecent:"\u6e05\u7a7a",clearrecentconfirm:"\u786e\u8ba4\u6e05\u7a7a\u6700\u8fd1\u6587\u6863\u5217\u8868\uff1f",cleardraft:"\u6e05\u7a7a",cleardraftconfirm:"\u786e\u8ba4\u6e05\u7a7a\u8349\u7a3f\u7bb1\uff1f",none_share:"\u4e0d\u5206\u4eab",public_share:"\u516c\u5f00\u5206\u4eab",password_share:"\u79c1\u5bc6\u5206\u4eab",email_share:"\u90ae\u4ef6\u9080\u8bf7",url_share:"\u8111\u56fe URL \u5730\u5740\uff1a",sns_share:"\u793e\u4ea4\u7f51\u7edc\u5206\u4eab\uff1a",sns_share_text:"\u201c{0}\u201d - \u6211\u7528\u767e\u5ea6\u8111\u56fe\u5236\u4f5c\u7684\u601d\u7ef4\u5bfc\u56fe\uff0c\u5feb\u770b\u770b\u5427\uff01\uff08\u5730\u5740\uff1a{1}\uff09",none_share_description:"\u4e0d\u5206\u4eab\u5f53\u524d\u8111\u56fe",public_share_description:"\u521b\u5efa\u4efb\u4f55\u4eba\u53ef\u89c1\u7684\u5206\u4eab",share_button_text:"\u521b\u5efa",password_share_description:"\u521b\u5efa\u9700\u8981\u5bc6\u7801\u624d\u53ef\u89c1\u7684\u5206\u4eab",email_share_description:"\u521b\u5efa\u6307\u5b9a\u4eba\u53ef\u89c1\u7684\u5206\u4eab\uff0c\u60a8\u8fd8\u53ef\u4ee5\u5141\u8bb8\u4ed6\u4eec\u7f16\u8f91",ondev:"\u656c\u8bf7\u671f\u5f85\uff01",create_share_failed:"\u5206\u4eab\u5931\u8d25\uff1a{0}",remove_share_failed:"\u5220\u9664\u5931\u8d25\uff1a{1}",copy:"\u590d\u5236",copied:"\u5df2\u590d\u5236",shared_tip:"\u5f53\u524d\u8111\u56fe\u88ab {0}  \u5206\u4eab\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539\u4e4b\u540e\u4fdd\u5b58\u5230\u81ea\u5df1\u7684\u7f51\u76d8\u4e0a\u6216\u518d\u6b21\u5206\u4eab",current_share:"\u5f53\u524d\u8111\u56fe",manage_share:"\u6211\u7684\u5206\u4eab",share_remove_action:"\u4e0d\u5206\u4eab\u8be5\u8111\u56fe",share_view_action:"\u6253\u5f00\u5206\u4eab\u5730\u5740",share_edit_action:"\u7f16\u8f91\u5206\u4eab\u7684\u6587\u4ef6",login:"\u767b\u5f55",logout:"\u6ce8\u9500",switchuser:"\u5207\u6362\u8d26\u6237",userinfo:"\u4e2a\u4eba\u4fe1\u606f",gotonetdisk:"\u6211\u7684\u7f51\u76d8",requirelogin:'\u8bf7 <a class="login-button">\u767b\u5f55</a> \u540e\u4f7f\u7528',saveas:"\u4fdd\u5b58\u4e3a",filename:"\u6587\u4ef6\u540d",fileformat:"\u4fdd\u5b58\u683c\u5f0f",save:"\u4fdd\u5b58",mkdir:"\u65b0\u5efa\u76ee\u5f55",recycle:"\u56de\u6536\u7ad9",newdir:"\u672a\u547d\u540d\u76ee\u5f55",bold:"\u52a0\u7c97",italic:"\u659c\u4f53",forecolor:"\u5b57\u4f53\u989c\u8272",fontfamily:"\u5b57\u4f53",fontsize:"\u5b57\u53f7",layoutstyle:"\u4e3b\u9898",node:"\u8282\u70b9\u64cd\u4f5c",saveto:"\u53e6\u5b58\u4e3a",hand:"\u5141\u8bb8\u62d6\u62fd",camera:"\u5b9a\u4f4d\u6839\u8282\u70b9","zoom-in":"\u653e\u5927\uff08Ctrl+\uff09","zoom-out":"\u7f29\u5c0f\uff08Ctrl-\uff09",markers:"\u6807\u7b7e",resource:"\u8d44\u6e90",help:"\u5e2e\u52a9",preference:"\u504f\u597d\u8bbe\u7f6e",expandnode:"\u5c55\u5f00\u5230\u53f6\u5b50",collapsenode:"\u6536\u8d77\u5230\u4e00\u7ea7\u8282\u70b9",template:"\u6a21\u677f",theme:"\u76ae\u80a4",clearstyle:"\u6e05\u9664\u6837\u5f0f",copystyle:"\u590d\u5236\u6837\u5f0f",pastestyle:"\u7c98\u8d34\u6837\u5f0f",appendsiblingnode:"\u540c\u7ea7\u4e3b\u9898",appendchildnode:"\u4e0b\u7ea7\u4e3b\u9898",arrangeup:"\u524d\u8c03",arrangedown:"\u540e\u8c03",editnode:"\u7f16\u8f91",removenode:"\u79fb\u9664",priority:"\u4f18\u5148\u7ea7",progress:{p1:"\u672a\u5f00\u59cb",p2:"\u5b8c\u6210 1/8",p3:"\u5b8c\u6210 1/4",p4:"\u5b8c\u6210 3/8",p5:"\u5b8c\u6210\u4e00\u534a",p6:"\u5b8c\u6210 5/8",p7:"\u5b8c\u6210 3/4",p8:"\u5b8c\u6210 7/8",p9:"\u5df2\u5b8c\u6210",p0:"\u6e05\u9664\u8fdb\u5ea6"},link:"\u94fe\u63a5",image:"\u56fe\u7247",note:"\u5907\u6ce8",insertlink:"\u63d2\u5165\u94fe\u63a5",insertimage:"\u63d2\u5165\u56fe\u7247",insertnote:"\u63d2\u5165\u5907\u6ce8",removelink:"\u79fb\u9664\u5df2\u6709\u94fe\u63a5",removeimage:"\u79fb\u9664\u5df2\u6709\u56fe\u7247",removenote:"\u79fb\u9664\u5df2\u6709\u5907\u6ce8",resetlayout:"\u6574\u7406",justnow:"\u521a\u521a",minutesago:"{0} \u5206\u949f\u524d",hoursago:"{0} \u5c0f\u65f6\u524d",yesterday:"\u6628\u5929",daysago:"{0} \u5929\u524d",longago:"\u5f88\u4e45\u4e4b\u524d",redirect:"\u60a8\u6b63\u5728\u6253\u5f00\u8fde\u63a5 {0}\uff0c\u767e\u5ea6\u8111\u56fe\u4e0d\u80fd\u4fdd\u8bc1\u8fde\u63a5\u7684\u5b89\u5168\u6027\uff0c\u662f\u5426\u8981\u7ee7\u7eed\uff1f",navigator:"\u5bfc\u822a\u5668",unsavedcontent:"\u5f53\u524d\u6587\u4ef6\u8fd8\u6ca1\u6709\u4fdd\u5b58\u5230\u7f51\u76d8\uff1a\n\n{0}\n\n\u867d\u7136\u672a\u4fdd\u5b58\u7684\u6570\u636e\u4f1a\u7f13\u5b58\u5728\u8349\u7a3f\u7bb1\uff0c\u4f46\u662f\u6e05\u9664\u6d4f\u89c8\u5668\u7f13\u5b58\u4f1a\u5bfc\u81f4\u8349\u7a3f\u7bb1\u6e05\u9664\u3002",shortcuts:"\u5feb\u6377\u952e",contact:"\u8054\u7cfb\u4e0e\u53cd\u9988",email:"\u90ae\u4ef6\u7ec4",qq_group:"QQ \u7fa4",github_issue:"Github",baidu_tieba:"\u8d34\u5427",clipboardunsupported:"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u526a\u8d34\u677f\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952e\u590d\u5236",load_success:"{0} \u52a0\u8f7d\u6210\u529f",save_success:"{0} \u5df2\u4fdd\u5b58\u4e8e {1}",autosave_success:"{0} \u5df2\u81ea\u52a8\u4fdd\u5b58\u4e8e {1}",selectall:"\u5168\u9009",selectrevert:"\u53cd\u9009",selectsiblings:"\u9009\u62e9\u5144\u5f1f\u8282\u70b9",selectlevel:"\u9009\u62e9\u540c\u7ea7\u8282\u70b9",selectpath:"\u9009\u62e9\u8def\u5f84",selecttree:"\u9009\u62e9\u5b50\u6811"},popupcolor:{clearColor:"\u6e05\u7a7a\u989c\u8272",standardColor:"\u6807\u51c6\u989c\u8272",themeColor:"\u4e3b\u9898\u989c\u8272"},dialogs:{markers:{"static":{lang_input_text:"\u6587\u672c\u5185\u5bb9\uff1a",lang_input_url:"\u94fe\u63a5\u5730\u5740\uff1a",lang_input_title:"\u6807\u9898\uff1a",lang_input_target:"\u662f\u5426\u5728\u65b0\u7a97\u53e3\uff1a"},priority:"\u4f18\u5148\u7ea7",none:"\u65e0",progress:{title:"\u8fdb\u5ea6",notdone:"\u672a\u5b8c\u6210",done1:"\u5b8c\u6210 1/8",done2:"\u5b8c\u6210 1/4",done3:"\u5b8c\u6210 3/8",done4:"\u5b8c\u6210 1/2",done5:"\u5b8c\u6210 5/8",done6:"\u5b8c\u6210 3/4",done7:"\u5b8c\u6210 7/8",done:"\u5df2\u5b8c\u6210"}},help:{},hyperlink:{},image:{},resource:{}},hyperlink:{hyperlink:"\u94fe\u63a5...",unhyperlink:"\u79fb\u9664\u94fe\u63a5"},image:{image:"\u56fe\u7247...",removeimage:"\u79fb\u9664\u56fe\u7247"},marker:{marker:"\u8fdb\u5ea6/\u4f18\u5148\u7ea7..."},resource:{resource:"\u8d44\u6e90..."}}}}),angular.module("kityminderEditor").service("memory",function(){function r(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}return{get:function(e){var t=window.localStorage.getItem(e);return JSON.parse(t)},set:function(e,t){try{return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){if(r(n))return!1}},remove:function(e){var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),t},clear:function(){window.localStorage.clear()}}}),angular.module("kityminderEditor").service("minder.service",function(){var t=[];function e(e){t.push(e)}function n(){t.forEach(function(e){e.apply(this,arguments)})}return{registerEvent:e,executeCallback:n}}),angular.module("kityminderEditor").service("resourceService",["$document",function(t){var n=null;this.open=function(e){n||(t.bind("click",r),t.bind("keydown",i)),n&&n!==e&&(n.resourceListOpen=!1),n=e},this.close=function(e){n===e&&(n=null,t.unbind("click",r),t.unbind("keydown",i))};var r=function(e){if(n){var t=n.getToggleElement();e&&t&&t[0].contains(e.target)||n.$apply(function(){console.log("to close the resourcelist"),n.resourceListOpen=!1})}},i=function(e){27===e.which&&(n.focusToggleElement(),r())}}]),angular.module("kityminderEditor").service("revokeDialog",["$modal","minder.service",function(t,e){return e.registerEvent(function(){var n=window.minder,r=window.editor,i=r.hotbox.getParentFSM();n.on("importNodeData",function(){var e;i.jump("modal","import-text-modal"),t.open({animation:!0,templateUrl:"ui/dialog/imExportNode/imExportNode.tpl.html",controller:"imExportNode.ctrl",size:"md",resolve:{title:function(){return"\u5bfc\u5165\u8282\u70b9"},defaultValue:function(){return""},type:function(){return"import"}}}).result.then(function(e){try{n.Text2Children(n.getSelectedNode(),e)}catch(t){alert(t)}i.jump("normal","import-text-finish"),r.receiver.selectAll()},function(){i.jump("normal","import-text-finish"),r.receiver.selectAll()})}),n.on("exportNodeData",function(){var e;i.jump("modal","export-text-modal"),t.open({animation:!0,templateUrl:"ui/dialog/imExportNode/imExportNode.tpl.html",controller:"imExportNode.ctrl",size:"md",resolve:{title:function(){return"\u5bfc\u51fa\u8282\u70b9"},defaultValue:function(){var e=n.getSelectedNode(),t;return(0,window.kityminder.data.getRegisterProtocol("text").Node2Text)(e)},type:function(){return"export"}}}).result.then(function(e){i.jump("normal","export-text-finish"),r.receiver.selectAll()},function(){i.jump("normal","export-text-finish"),r.receiver.selectAll()})})}),{}}]),angular.module("kityminderEditor").service("server",["config","$http",function(r,i){return{uploadImage:function(e){var t=r.get("imageUpload"),n=new FormData;return n.append("upload_file",e),i.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":undefined}})}}}]),angular.module("kityminderEditor").service("valueTransfer",function(){return{}}),angular.module("kityminderEditor").filter("commandState",function(){return function(e,t){return e.queryCommandState(t)}}).filter("commandValue",function(){return function(e,t){return e.queryCommandValue(t)}}),angular.module("kityminderEditor").filter("lang",["config","lang.zh-cn",function(i,o){return function(e,t){var n=i.get("defaultLang");if(o[n]==undefined)return"\u672a\u53d1\u73b0\u5bf9\u5e94\u8bed\u8a00\u5305\uff0c\u8bf7\u68c0\u67e5 lang.xxx.service.js!";var r=o[n];return t.split("/").forEach(function(e,t){r=r[e]}),r[e]||null}}]),angular.module("kityminderEditor").controller("hyperlink.ctrl",["$scope","$modalInstance","link",function(t,n,e){var r="^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$";t.R_URL=new RegExp(r,"i"),t.url=e.url||"",t.title=e.title||"",setTimeout(function(){var e=$("#link-url");e.focus(),e[0].setSelectionRange(0,t.url.length)},30),t.shortCut=function(e){e.stopPropagation(),13==e.keyCode?t.ok():27==e.keyCode&&t.cancel()},t.ok=function(){if(t.R_URL.test(t.url))n.close({url:t.url,title:t.title});else{t.urlPassed=!1;var e=$("#link-url");e.focus(),e[0].setSelectionRange(0,t.url.length)}editor.receiver.selectAll()},t.cancel=function(){n.dismiss("cancel"),editor.receiver.selectAll()}}]),angular.module("kityminderEditor").controller("imExportNode.ctrl",["$scope","$modalInstance","title","defaultValue","type",function(i,e,t,n,o){function a(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function l(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}i.title=t,i.value=n,i.type=o,i.ok=function(){""!=i.value&&(e.close(i.value),editor.receiver.selectAll())},i.cancel=function(){e.dismiss("cancel"),editor.receiver.selectAll()},setTimeout(function(){$(".single-input").focus(),$(".single-input")[0].setSelectionRange(0,n.length)},30),i.shortCut=function(e){if(e.stopPropagation(),27==e.keyCode&&i.cancel(),8==e.keyCode&&"export"==o&&e.preventDefault(),9==e.keyCode){e.preventDefault();var t=e.target,n=a(t),r=t.value;t.value=r.substr(0,n)+"\t"+r.substr(n),l(t,n+1)}}}]),angular.module("kityminderEditor").controller("image.ctrl",["$http","$scope","$modalInstance","image","server",function(r,i,t,e,n){function o(){var e=i.data.searchKeyword2,t,n="http://image.baidu.com/search/acjson?tn=resultjson_com&ipn=rj&ct=201326592&fp=result&queryWord="+e+"&cl=2&lm=-1&ie=utf-8&oe=utf-8&st=-1&ic=0&word="+e+"&face=0&istype=2&nc=1&pn=60&rn=60&gsm=3c&"+(new Date).getTime()+"=&callback=JSON_CALLBACK";return r.jsonp(n)}i.data={list:[],url:e.url||"",title:e.title||"",R_URL:/^https?\:\/\/\w+/},setTimeout(function(){var e=$("#image-url");e.focus(),e[0].setSelectionRange(0,i.data.url.length)},300),i.searchImage=function(){i.list=[],o().success(function(e){if(e&&e.data)for(var t=0;t<e.data.length;t++)e.data[t].objURL&&i.list.push({title:e.data[t].fromPageTitleEnc,src:e.data[t].middleURL,url:e.data[t].middleURL})}).error(function(){})},i.selectImage=function(e){var t=$("#img-item"+this.$index),n=$("#img-"+this.$index);t.siblings(".selected").removeClass("selected"),t.addClass("selected"),i.data.url=n.attr("src"),i.data.title=n.attr("alt")},i.uploadImage=function(){var e=$("#upload-image");if(e.val()){if(/^.*\.(jpg|JPG|jpeg|JPEG|gif|GIF|png|PNG)$/.test(e.val())){var t=e[0].files[0];return n.uploadImage(t).then(function(e){var t=e.data;0===t.errno&&(i.data.url=t.data.url)})}alert("\u540e\u7f00\u53ea\u80fd\u662f jpg\u3001gif \u53ca png")}},i.shortCut=function(e){e.stopPropagation(),13==e.keyCode?i.ok():27==e.keyCode&&i.cancel()},i.ok=function(){if(i.data.R_URL.test(i.data.url))t.close({url:i.data.url,title:i.data.title});else{i.urlPassed=!1;var e=$("#image-url");e&&(e.focus(),e[0].setSelectionRange(0,i.data.url.length))}editor.receiver.selectAll()},i.cancel=function(){t.dismiss("cancel"),editor.receiver.selectAll()}}]),angular.module("kityminderEditor").directive("appendNode",["commandBinder",function(n){return{restrict:"E",templateUrl:"ui/directive/appendNode/appendNode.html",scope:{minder:"="},replace:!0,link:function(e){var r=e.minder;function t(){var e=editor.receiver.element,t=editor.fsm,n=editor.receiver;e.innerText=r.queryCommandValue("text"),t.jump("input","input-request"),n.selectAll()}n.bind(r,"appendchildnode",e),e.execCommand=function(e){r.execCommand(e,"\u5206\u652f\u4e3b\u9898"),t()}}}}]),angular.module("kityminderEditor").directive("arrange",["commandBinder",function(e){return{restrict:"E",templateUrl:"ui/directive/arrange/arrange.html",scope:{minder:"="},replace:!0,link:function(e){var t=e.minder}}}]),angular.module("kityminderEditor").directive("colorPanel",function(){return{restrict:"E",templateUrl:"ui/directive/colorPanel/colorPanel.html",scope:{minder:"="},replace:!0,link:function(n){var r=n.minder,e=r.getThemeItems();n.$on("colorPicked",function(e,t){e.stopPropagation(),n.bgColor=t,r.execCommand("background",t)}),n.setDefaultBg=function(){var e=r.getSelectedNode(),t=r.getNodeStyle(e,"background");return"object"==typeof t?t.toHEX():t},n.bgColor=n.setDefaultBg()||"#fff"}}}),angular.module("kityminderEditor").directive("expandLevel",function(){return{restrict:"E",templateUrl:"ui/directive/expandLevel/expandLevel.html",scope:{minder:"="},replace:!0,link:function(e){e.levels=[1,2,3,4,5,6]}}}),angular.module("kityminderEditor").directive("exportPanel",function(){return{restrict:"E",templateUrl:"ui/directive/exportPanel/exportPanel.html",scope:{minder:"="},replace:!0,link:function(i){i.exportKm=function(){var e=i.minder.exportJson(),t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="mindmap.km",r.click()},i.exportPng=function(){i.minder.exportData("png").then(function(e){var t=document.createElement("a");t.href=e,t.download="mindmap.png",t.click()})}}}}),angular.module("kityminderEditor").directive("fontOperator",function(){return{restrict:"E",templateUrl:"ui/directive/fontOperator/fontOperator.html",scope:{minder:"="},replace:!0,link:function(n){var r=n.minder,e=r.getThemeItems();n.fontSizeList=[10,12,16,18,24,32,48],n.fontFamilyList=[{name:"\u5b8b\u4f53",val:"\u5b8b\u4f53,SimSun"},{name:"\u5fae\u8f6f\u96c5\u9ed1",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"\u6977\u4f53",val:"\u6977\u4f53,\u6977\u4f53_GB2312,SimKai"},{name:"\u9ed1\u4f53",val:"\u9ed1\u4f53, SimHei"},{name:"\u96b6\u4e66",val:"\u96b6\u4e66, SimLi"},{name:"Andale Mono",val:"andale mono"},{name:"Arial",val:"arial,helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"Comic Sans Ms",val:"comic sans ms"},{name:"Impact",val:"impact,chicago"},{name:"Times New Roman",val:"times new roman"},{name:"Sans-Serif",val:"sans-serif"}],n.$on("colorPicked",function(e,t){e.stopPropagation(),n.foreColor=t,r.execCommand("forecolor",t)}),n.setDefaultColor=function(){var e=r.getSelectedNode(),t=r.getNodeStyle(e,"color");return"object"==typeof t?t.toHEX():t},n.foreColor=n.setDefaultColor()||"#000",n.getFontfamilyName=function(r){var i="";return n.fontFamilyList.forEach(function(e,t,n){if(e.val===r)return i=e.name,""}),i}}}}),angular.module("kityminderEditor").directive("hyperLink",["$modal",function(r){return{restrict:"E",templateUrl:"ui/directive/hyperLink/hyperLink.html",scope:{minder:"="},replace:!0,link:function(e){var n=e.minder;e.addHyperlink=function(){var e=n.queryCommandValue("HyperLink"),t;r.open({animation:!0,templateUrl:"ui/dialog/hyperlink/hyperlink.tpl.html",controller:"hyperlink.ctrl",size:"md",resolve:{link:function(){return e}}}).result.then(function(e){n.execCommand("HyperLink",e.url,e.title||"")})}}}}]),angular.module("kityminderEditor").directive("imageBtn",["$modal",function(r){return{restrict:"E",templateUrl:"ui/directive/imageBtn/imageBtn.html",scope:{minder:"="},replace:!0,link:function(e){var n=e.minder;e.addImage=function(){var e=n.queryCommandValue("image"),t;r.open({animation:!0,templateUrl:"ui/dialog/image/image.tpl.html",controller:"image.ctrl",size:"md",resolve:{image:function(){return e}}}).result.then(function(e){n.execCommand("image",e.url,e.title||"")})}}}}]),angular.module("kityminderEditor").directive("kityminderEditor",["config","minder.service","revokeDialog",function(a,l,e){return{restrict:"EA",templateUrl:"ui/directive/kityminderEditor/kityminderEditor.html",replace:!0,scope:{onInit:"&"},link:function(r,e,t){var i=e.children(".minder-editor")[0];function o(e,t){r.onInit({editor:e,minder:t}),l.executeCallback()}if("undefined"!=typeof seajs)seajs.config({base:"./src"}),define("demo",function(e){var t=e("editor"),n=window.editor=new t(i);window.localStorage.__dev_minder_content&&n.minder.importJson(JSON.parse(window.localStorage.__dev_minder_content)),n.minder.on("contentchange",function(){window.localStorage.__dev_minder_content=JSON.stringify(n.minder.exportJson())}),window.minder=window.km=n.minder,r.editor=n,r.minder=minder,r.config=a.get(),r.$apply(),o(n,minder)}),seajs.use("demo");else if(window.kityminder&&window.kityminder.Editor){var n=new kityminder.Editor(i);window.editor=r.editor=n,window.minder=r.minder=n.minder,r.config=a.get(),o(n,n.minder)}}}}]),angular.module("kityminderEditor").directive("kityminderViewer",["config","minder.service",function(e,a){return{restrict:"EA",templateUrl:"ui/directive/kityminderViewer/kityminderViewer.html",replace:!0,scope:{onInit:"&"},link:function(n,e,t){var r=e.children(".minder-viewer")[0];function i(e,t){n.onInit({editor:e,minder:t}),a.executeCallback()}if(window.kityminder&&window.kityminder.Editor){var o=new kityminder.Editor(r);window.editor=n.editor=o,window.minder=n.minder=o.minder,i(o,o.minder)}}}}]),angular.module("kityminderEditor").directive("layout",function(){return{restrict:"E",templateUrl:"ui/directive/layout/layout.html",scope:{minder:"="},replace:!0,link:function(e){}}}),angular.module("kityminderEditor").directive("markdownImport",function(){return{restrict:"E",templateUrl:"ui/directive/markdownImport/markdownImport.html",scope:{minder:"="},controller:["$scope","$http","$timeout",function(c,e,d){function t(){e({method:"GET",url:"http://localhost:3001/api/models"}).then(function(e){e.data&&e.data.models?c.modelList=e.data.models:console.error("\u83b7\u53d6\u6a21\u578b\u5217\u8868\u5931\u8d25: \u6570\u636e\u683c\u5f0f\u4e0d\u6b63\u786e")})["catch"](function(e){console.error("\u83b7\u53d6\u6a21\u578b\u5217\u8868\u5931\u8d25:",e)})}function n(e){try{var t=JSON.parse(e);return t.root?t.root:t}catch(g){var n=e.split("\n").filter(function(e){return e.trim()});if(0===n.length)return{data:{text:"\u4e2d\u5fc3\u4e3b\u9898"},children:[]};for(var r=null,i=0,o=[],a=0;a<n.length;a++){var l=n[a],c=l.match(/^(#+)\s+(.+)/);if(c){var d=c[1].length,e,s={data:{text:e=c[2].trim()},children:[]},u;if(!r){o=[r=s];continue}for(;o.length>d;)o.pop();for(;o.length<d;){var m=o[o.length-1],p={data:{text:"\u5206\u652f\u4e3b\u9898 "+(m.children.length+1)},children:[]};m.children.push(p),o.push(p)}(u=o[o.length-1]).children.push(s),o[d]=s}else{var e;if(e=l.trim())if(r){var s={data:{text:e},children:[]},u;(u=o[o.length-1]).children.push(s)}else o=[r={data:{text:e},children:[]}]}}return r}}c.markdownContent="",c.modelList=[],c.selectedModel="",c.userMessage="",c.chatMessages=[],t(),c.onModelChange=function(){c.selectedModel&&(c.chatMessages=[])},c.sendMessage=function(){if(c.userMessage&&c.selectedModel){var e;c.chatMessages.push({role:"user",content:c.userMessage});var t=c.userMessage+', \u6570\u636e\u4e25\u683c\u53c2\u7167\u4e0b\u9762\u7684json\u683c\u5f0f\uff1a{"root":{"data":{"id":"d68jsqbo2y80","created":1733887432829,"text":"\u5c0f\u7a0b\u5e8f\u63a8\u5e7f"},"children":[{"data":{"id":"d68jsuf1i740","created":1733887441741,"text":"\u6280\u672f\u793e\u533a"},"children":[{"data":{"id":"d68jszaz4400","created":1733887452379,"text":"\u64b0\u5199\u6280\u672f\u535a\u5ba2"},"children":[]},{"data":{"id":"d68jttfqqs00","created":1733887517970,"text":"\u6848\u4f8b\u5206\u4eab"},"children":[]},{"data":{"id":"d68jtxj0tdk0","created":1733887526876,"text":"\u5f00\u6e90\u8d21\u732e"},"children":[]}]},{"data":{"id":"d68ju0bjdx40","created":1733887532954,"text":"\u793e\u4ea4\u7f51\u7edc"},"children":[{"data":{"id":"d68ju78p8i80","created":1733887548019,"text":"\u5c0f\u7ea2\u4e66\uff0c\u6296\u97f3\u7b49\u3002\u8bb2\u8ff0\u4ea7\u54c1\u6545\u4e8b"},"children":[]},{"data":{"id":"d68jubigmfs0","created":1733887557317,"text":"\u53d1\u8d77\u4e92\u52a8\u6d3b\u52a8"},"children":[]}]},{"data":{"id":"d68jumx4d6w0","created":1733887582148,"text":"\u8eab\u8fb9"},"children":[{"data":{"id":"d68jv7w3wuw0","created":1733887627799,"text":"\u5206\u4eab\u670b\u53cb\u5708"},"children":[]},{"data":{"id":"d68jvddt15k0","created":1733887639753,"text":"\u5206\u4eab\u5fae\u4fe1\u7fa4"},"children":[]}]},{"data":{"id":"d68jvp6lb140","created":1733887665438,"text":"SEO"},"children":[{"data":{"id":"d68jvr5yowo0","created":1733887669754,"text":"\u8f6f\u4ef6\u6280\u672f\u5c42\u9762\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u4f18\u5316\uff08SEO\uff09"},"children":[]}]},{"data":{"id":"d68jw1ega2o0","created":1733887692035,"text":"\u4ea7\u54c1\u7528\u6237\u88c2\u53d8"},"children":[{"data":{"id":"d68jw8kb2680","created":1733887707626,"text":"\u5206\u4eab\u5956\u52b1"},"children":[]},{"data":{"id":"d68jwb2var40","created":1733887713102,"text":"\u6bcf\u65e5\u6d3b\u52a8"},"children":[]},{"data":{"id":"d68jwfiauig0","created":1733887722743,"text":"\u4ea7\u54c1\u793e\u533a\u9891\u9053"},"children":[]}]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}',l={role:"assistant",content:c.userMessage=""};c.chatMessages.push(l),fetch("http://localhost:3001/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:c.selectedModel,prompt:t})}).then(function(e){if(!e.ok)throw new Error("\u7f51\u7edc\u54cd\u5e94\u4e0d\u6b63\u5e38");var t=e.body.getReader(),a="";function o(){return t.read().then(function(e){var t=e.done,n=e.value,r,i;if(!t)return(new TextDecoder).decode(n).split("\n").forEach(function(e){if(e.trim())try{var t=JSON.parse(e.replace(/^data: /,""));if(console.log("55555data:",t),t.error?c.$apply(function(){l.content="\u53d1\u9001\u6d88\u606f\u5931\u8d25\uff1a"+t.error,l.role="error"}):t.response&&(c.$apply(function(){l.content+=t.response,a+=t.response}),d(function(){var e=document.getElementById("chatMessages");e&&(e.scrollTop=e.scrollHeight)},0),console.log("66666data.done:",t.done)),t.done){console.log("\u6536\u5230\u5b8c\u6574\u7684\u54cd\u5e94:",a);var n=a.match(/```json\s*([\s\S]*?)```/)||a.match(/\{[\s\S]*?\}/g);if(n)try{var r=(n[1]||n[0]).trim(),i=JSON.parse(r);i&&(i.root||i.data)?c.$apply(function(){c.markdownContent=JSON.stringify(i,null,2),c.convertToMindmap()}):console.error("\u65e0\u6548\u7684\u601d\u7ef4\u5bfc\u56fe\u6570\u636e\u7ed3\u6784")}catch(o){console.error("\u89e3\u6790JSON\u6570\u636e\u5931\u8d25:",o),console.error("JSON\u5b57\u7b26\u4e32:",r)}}}catch(o){console.error("\u89e3\u6790\u54cd\u5e94\u6570\u636e\u5931\u8d25:",o)}}),o()})}return o()})["catch"](function(e){console.error("\u8bf7\u6c42\u5931\u8d25:",e),c.$apply(function(){l.content||(l.content="\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",l.role="error")})})}},c.convertToMindmap=function(){if(c.markdownContent)try{var e=n(c.markdownContent);c.minder.importJson(e)}catch(t){console.error("\u8f6c\u6362\u5931\u8d25:",t)}},c.importMarkdown=function(){if(c.markdownContent)try{var e=n(c.markdownContent);c.minder.importJson(e)}catch(t){console.error("\u5bfc\u5165\u5931\u8d25:",t)}},c.clearMarkdown=function(){c.markdownContent="",c.minder.importJson({data:{text:"\u4e2d\u5fc3\u4e3b\u9898"},children:[]})}}]}}),angular.module("kityminderEditor").directive("navigator",["memory","config",function(f,v){return{restrict:"A",templateUrl:"ui/directive/navigator/navigator.html",scope:{minder:"="},link:function(n){function e(){minder.on("layout layoutallfinish",p),minder.on("viewchange",g)}function t(){minder.off("layout layoutallfinish",p),minder.off("viewchange",g)}minder.setDefaultOptions({zoom:v.get("zoom")}),n.isNavOpen=!f.get("navigator-hidden"),n.getZoomRadio=function(e){var t=minder.getOption("zoom"),n=t[0],r,i;return 1-(e-n)/(t[t.length-1]-n)},n.getHeight=function(e){var t=$(".zoom-pan").height();return n.getZoomRadio(e)*t},n.zoom=100,minder.on("zoom",function(e){n.zoom=e.zoom}),n.toggleNavOpen=function(){n.isNavOpen=!n.isNavOpen,f.set("navigator-hidden",!n.isNavOpen),n.isNavOpen?(e(),p(),g()):t()},setTimeout(function(){n.isNavOpen?(e(),p(),g()):t()},0);var r=$(".nav-previewer"),i=new kity.Paper(r[0]),o=i.put(new kity.Path),a=i.put(new kity.Path),l=i.put(new kity.Rect(100,100).stroke("red","1%")),c=new kity.Box,d=new kity.Box,s=u(minder.getTheme());function u(e){switch(e){case"tianpan":case"tianpan-compact":return function(e,t,n,r,i){var o=r>>1;e.push("M",t,n+o,"a",o,o,0,1,1,0,.01,"z")};default:return function(e,t,n,r,i){e.push("M",t,n,"h",r,"v",i,"h",-r,"z")}}}function m(){function t(e,t){var n=d,r;e.x=-e.x,e.y=-e.y,n=minder.getPaper().getViewPortMatrix().transformBox(n);var i=e.offset(n.width/2,n.height/2);minder.getViewDragger().moveTo(i,t)}var n=!1;i.on("mousedown",function(e){n=!0,t(e.getPosition("top"),200),r.addClass("grab")}),i.on("mousemove",function(e){n&&t(e.getPosition("top"))}),$(window).on("mouseup",function(){n=!1,r.removeClass("grab")})}function p(){var e=minder.getRenderContainer().getBoundaryBox();c=e;var t=30;i.setViewBox(e.x-30-.5,e.y-30-.5,e.width+60+1,e.height+60+1);var n=[],r=[];minder.getRoot().traverse(function(e){var t=e.getLayoutBox();s(n,t.x,t.y,t.width,t.height),e.getConnection()&&e.parent&&e.parent.isExpanded()&&r.push(e.getConnection().getPathData())}),i.setStyle("background",minder.getStyle("background")),n.length?o.fill(minder.getStyle("root-background")).setPathData(n):o.setPathData(null),r.length?a.stroke(minder.getStyle("connect-color"),"0.5%").setPathData(r):a.setPathData(null),g()}function g(){d=minder.getViewDragger().getView(),l.setBox(d.intersect(c))}minder.on("themechange",function(e){s=u(e.theme)}),m()}}}]),angular.module("kityminderEditor").directive("noteBtn",["valueTransfer",function(n){return{restrict:"E",templateUrl:"ui/directive/noteBtn/noteBtn.html",scope:{minder:"="},replace:!0,link:function(e){var t=e.minder;e.addNote=function(){n.noteEditorOpen=!0}}}}]),angular.module("kityminderEditor").directive("noteEditor",["valueTransfer",function(a){return{restrict:"A",templateUrl:"ui/directive/noteEditor/noteEditor.html",scope:{minder:"="},replace:!0,controller:["$scope",function(n){var r=n.minder,i=!1,o;function e(){var e=n.noteEnabled=-1!=r.queryCommandState("note"),t=r.queryCommandValue("note")||"";e&&(n.noteContent=t),i=!0,n.$apply(),i=!1}n.codemirrorLoaded=function(e){o=n.cmEditor=e,e.setSize("100%","100%")},n.$watch("noteContent",function(e){var t=-1!=r.queryCommandState("note");e&&t&&!i&&r.execCommand("note",e),setTimeout(function(){o.refresh()})});var t=function(){return a.noteEditorOpen};n.$watch(t,function(e,t){e&&setTimeout(function(){o.refresh(),o.focus()}),n.noteEditorOpen=a.noteEditorOpen},!0),n.closeNoteEditor=function(){a.noteEditorOpen=!1,editor.receiver.selectAll()},r.on("interactchange",e)}]}}]),angular.module("kityminderEditor").directive("notePreviewer",["$sce","valueTransfer",function(h,e){return{restrict:"A",templateUrl:"ui/directive/notePreviewer/notePreviewer.html",link:function(p,e){var t=p.minder,g=e.parent(),f=e.children(),n;p.showNotePreviewer=!1,marked.setOptions({gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!0,smartLists:!0,smartypants:!1}),t.on("shownoterequest",function(e){n=setTimeout(function(){r(e.node,e.keyword)},300)}),t.on("hidenoterequest",function(){clearTimeout(n),p.showNotePreviewer=!1});var v=!1;function r(e,t){var n,r=e.getRenderer("NoteIconRenderer").getRenderShape().getRenderBox("screen"),i=e.getData("note");f[0].scrollTop=0;var o=marked(i);t&&(o=o.replace(new RegExp("("+t+")","ig"),'<span class="highlight">$1</span>')),p.noteContent=h.trustAsHtml(o),p.$apply();var a=$(g[0]).width(),l=$(g[0]).height(),c=$(f).outerWidth(),d=$(f).outerHeight(),s=r.cx-c/2-g[0].offsetLeft,u=r.bottom+10-g[0].offsetTop;s<0&&(s=10),a<s+c&&(s=r.left-c-10-g[0].offsetLeft),l<u+d&&(u=r.top-d-10-g[0].offsetTop),p.previewerStyle={left:Math.round(s)+"px",top:Math.round(u)+"px"},p.showNotePreviewer=!0;var m=f[0].querySelector(".highlight");m&&m.scrollIntoView(),v=!0,p.$apply()}$(document).on("mousedown mousewheel DOMMouseScroll",function(){v&&(p.showNotePreviewer=!1,p.$apply())}),e.on("mousedown mousewheel DOMMouseScroll",function(e){e.stopPropagation()})}}}]),angular.module("kityminderEditor").directive("operation",function(){return{restrict:"E",templateUrl:"ui/directive/operation/operation.html",scope:{minder:"="},replace:!0,link:function(e){e.editNode=function(){var e=editor.receiver.element,t=editor.fsm,n=editor.receiver;e.innerText=minder.queryCommandValue("text"),t.jump("input","input-request"),n.selectAll()}}}}),angular.module("kityminderEditor").directive("priorityEditor",["commandBinder",function(i){return{restrict:"E",templateUrl:"ui/directive/priorityEditor/priorityEditor.html",scope:{minder:"="},replace:!0,link:function(e){for(var t=e.minder,n=[],r=0;r<10;r++)n.push(r);i.bind(t,"priority",e),e.priorities=n,e.getPriorityTitle=function(e){switch(e){case 0:return"\u79fb\u9664\u4f18\u5148\u7ea7";default:return"\u4f18\u5148\u7ea7"+e}}}}}]),angular.module("kityminderEditor").directive("progressEditor",["commandBinder",function(i){return{restrict:"E",templateUrl:"ui/directive/progressEditor/progressEditor.html",scope:{minder:"="},replace:!0,link:function(e){for(var t=e.minder,n=[],r=0;r<10;r++)n.push(r);i.bind(t,"progress",e),e.progresses=n,e.getProgressTitle=function(e){switch(e){case 0:return"\u79fb\u9664\u8fdb\u5ea6";case 1:return"\u672a\u5f00\u59cb";case 9:return"\u5168\u90e8\u5b8c\u6210";default:return"\u5b8c\u6210"+(e-1)+"/8"}}}}}]),angular.module("kityminderEditor").directive("resourceEditor",function(){return{restrict:"E",templateUrl:"ui/directive/resourceEditor/resourceEditor.html",scope:{minder:"="},replace:!0,controller:["$scope",function(r){var i=r.minder,o=!1;i.on("interactchange",function(){var e,t=(r.enabled=-1!=i.queryCommandState("resource"))?i.queryCommandValue("resource"):[],n=i.getUsedResource().map(function(e){return{name:e,selected:-1<t.indexOf(e)}});r.used=n,o=!0,r.$apply(),o=!1}),r.$watch("used",function(e){if(-1!=i.queryCommandState("resource")&&e){var t=e.filter(function(e){return e.selected}).map(function(e){return e.name});if(o)return;i.execCommand("resource",t)}},!0),r.resourceColor=function(e){return i.getResourceColor(e).toHEX()},r.addResource=function(e){var t=i.queryCommandValue("resource");e&&/\S/.test(e)&&(-1==t.indexOf(e)&&r.used.push({name:e,selected:!0}),r.newResourceName=null)}}]}}).directive("clickAnywhereButHere",["$document",function(r){return{link:function(i,e,o){var n=function(e){var t=0<$("#resource-dropdown").has(e.target).length,n=$("#resource-dropdown")==e.target,r;t||n||i.$apply(o.clickAnywhereButHere)};i.$watch(o.isActive,function(e,t){e!==t&&1==e?r.bind("click",n):e!==t&&0==e&&r.unbind("click",n)})}}}]),angular.module("kityminderEditor").directive("searchBox",function(){return{restrict:"A",templateUrl:"ui/directive/searchBox/searchBox.html",scope:{minder:"="},replace:!0,controller:["$scope",function(o){var a=o.minder,e=window.editor;function t(e){if(13==e.keyCode){var t=e.shiftKey?"prev":"next";s(o.keyword,t)}27==e.keyCode&&n()}function n(){$("#search-input").blur(),o.showSearch=!1,a.fire("hidenoterequest"),e.receiver.selectAll()}function r(){o.showSearch=!0,setTimeout(function(){$("#search-input").focus()},10),o.keyword&&$("#search-input")[0].setSelectionRange(0,o.keyword.length)}o.handleKeyDown=t,o.doSearch=s,o.exitSearch=n,o.showTip=!1,o.showSearch=!1,$("body").on("keydown",function(e){70!=e.keyCode||!e.ctrlKey&&!e.metaKey||e.shiftKey||(r(),o.$apply(),e.preventDefault())}),a.on("searchNode",function(){r()});var l=[],c=[];function i(){l=[],a.getRoot().traverse(function(e){l.push(e)})}function d(e){c=[];for(var t=0;t<l.length;t++){var n=l[t],r;-1!=n.getText().toLowerCase().indexOf(e)&&c.push({node:n});var i=n.getData("note");i&&-1!=i.toLowerCase().indexOf(e)&&c.push({node:n,keyword:e})}}function s(e,t){if(o.showTip=!1,a.fire("hidenoterequest"),e&&/\S/.exec(e)){o.showTip=!0,o.curIndex=0,o.resultNum=0,e=e.toLowerCase();var n=s.lastKeyword!=e;if(s.lastKeyword=e,n&&d(e),o.resultNum=c.length,c.length){var r=n?0:("next"===t?s.lastIndex+1:s.lastIndex-1)||0;function i(e,t){a.execCommand("camera",e,50),setTimeout(function(){a.select(e,!0),e.isExpanded()||a.execCommand("expand",!0),t&&a.fire("shownoterequest",{node:e,keyword:t})},60)}r=(c.length+r)%c.length,i(c[r].node,c[r].keyword),s.lastIndex=r,o.curIndex=r+1}}else $("#search-input").focus()}a.on("contentchange",i),i()}]}}),angular.module("kityminderEditor").directive("searchBtn",function(){return{restrict:"E",templateUrl:"ui/directive/searchBtn/searchBtn.html",scope:{minder:"="},replace:!0,link:function(e){function t(){minder.fire("searchNode")}e.enterSearch=t}}}),angular.module("kityminderEditor").directive("selectAll",function(){return{restrict:"E",templateUrl:"ui/directive/selectAll/selectAll.html",scope:{minder:"="},replace:!0,link:function(e){var r=e.minder;e.items=["revert","siblings","level","path","tree"],e.select={all:function(){var t=[];r.getRoot().traverse(function(e){t.push(e)}),r.select(t,!0),r.fire("receiverfocus")},revert:function(){var t=r.getSelectedNodes(),n=[];r.getRoot().traverse(function(e){-1==t.indexOf(e)&&n.push(e)}),r.select(n,!0),r.fire("receiverfocus")},siblings:function(){var e=r.getSelectedNodes(),t=[];e.forEach(function(e){e.parent&&e.parent.children.forEach(function(e){-1==t.indexOf(e)&&t.push(e)})}),r.select(t,!0),r.fire("receiverfocus")},level:function(){var t=r.getSelectedNodes().map(function(e){return e.getLevel()}),n=[];r.getRoot().traverse(function(e){-1!=t.indexOf(e.getLevel())&&n.push(e)}),r.select(n,!0),r.fire("receiverfocus")},path:function(){var e=r.getSelectedNodes(),t=[];e.forEach(function(e){for(;e&&-1==t.indexOf(e);)t.push(e),e=e.parent}),r.select(t,!0),r.fire("receiverfocus")},tree:function(){var e=r.getSelectedNodes(),t=[];e.forEach(function(e){e.traverse(function(e){-1==t.indexOf(e)&&t.push(e)})}),r.select(t,!0),r.fire("receiverfocus")}}}}}),angular.module("kityminderEditor").directive("styleOperator",function(){return{restrict:"E",templateUrl:"ui/directive/styleOperator/styleOperator.html",scope:{minder:"="},replace:!0}}),angular.module("kityminderEditor").directive("templateList",function(){return{restrict:"E",templateUrl:"ui/directive/templateList/templateList.html",scope:{minder:"="},replace:!0,link:function(e){e.templateList=kityminder.Minder.getTemplateList()}}}),angular.module("kityminderEditor").directive("themeList",function(){return{restrict:"E",templateUrl:"ui/directive/themeList/themeList.html",replace:!0,link:function(e){var r=kityminder.Minder.getThemeList();e.getThemeThumbStyle=function(e){var t=r[e];if(t){var n={color:t["root-color"],"border-radius":t["root-radius"]/2};return t["root-background"]&&(n.background=t["root-background"].toString()),n}},e.themeKeyList=["classic","classic-compact","fresh-blue","fresh-blue-compat","fresh-green","fresh-green-compat","fresh-pink","fresh-pink-compat","fresh-purple","fresh-purple-compat","fresh-red","fresh-red-compat","fresh-soil","fresh-soil-compat","snow","snow-compact","tianpan","tianpan-compact","fish","wire"]}}}),angular.module("kityminderEditor").directive("topTab",function(){return{restrict:"A",templateUrl:"ui/directive/topTab/topTab.html",scope:{minder:"=topTab",editor:"="},link:function(e){var t=!1,n=!0,r=!0;function i(){var e=$(".tab-content"),t=$(".minder-editor");e.animate({height:0,display:"none"}),t.animate({top:"32px"})}function o(){var e=$(".tab-content"),t=$(".minder-editor");e.animate({height:"60px",display:"block"}),t.animate({top:"92px"})}e.setCurTab=function(e){setTimeout(function(){t=!0,"idea"!=e&&(n=!1)})},e.toggleTopTab=function(){setTimeout(function(){t&&!n||(n=!1,r?i():o(),r=!r),t=!1})}}}}),angular.module("kityminderEditor").directive("undoRedo",function(){return{restrict:"E",templateUrl:"ui/directive/undoRedo/undoRedo.html",scope:{editor:"="},replace:!0,link:function(e){}}}),e("expose-editor")}();